/* ===================================================
 * zlux
 * https://zoolanders.com
 * ===================================================
 * Copyright (C) JOOlanders SL
 * http://www.gnu.org/licenses/gpl-2.0.html
 * ========================================================== */
!function(a,b,c,d){"use strict";var e=a.zlux||{};return e.fn?e:(e.version="2.0",e.fn=function(b,c){var f=arguments,g=b.match(/^([a-z\-]+)(?:\.([a-z]+))?/i),h=g[1],i=g[2];return e[h]?this.each(function(){var b=a(this),g=b.data(h);g||b.data(h,g=e[h](this,i?d:c)),i&&g[i].apply(g,Array.prototype.slice.call(f,1))}):(a.error("UIkit component ["+h+"] does not exist."),this)},e.url={},e.url.urls={ajax:"",root:"",zlux:""},e.url.push=function(b){a.extend(e.url.urls,b)},e.url.get=function(b,c){return b=b.split(":"),c=c===d?{}:c,e.url.clean(2===b.length?e.url._get(b[0])+"/"+b[1]:b[0])+(a.isEmptyObject(c)?"":"&"+a.param(c))},e.url._get=function(a){return e.url.urls[a]!==d?e.url.urls[a]:a},e.url.clean=function(a){return a?a.replace(/\\/g,"/").replace(/\/\//g,"/").replace(/undefined/g,"").replace(/\/$/g,"").replace(/:\//g,"://"):""},e.lang={},e.lang.strings={},e.lang.push=function(b){a.extend(e.lang.strings,b)},e.lang.get=function(a){return e.lang.strings[a]||a},e.lang._=e.lang.get,e.lang.sprintf=function(a){var b=[].slice.call(arguments,1);return a=e.lang.get(a),a.replace(/%[a-z]/g,function(){var a=b.shift();return"undefined"!==e.utils.typeOf(a)?a:""})},e.utils={},e.utils.typeOf=function(a){return{}.toString.call(a).match(/\s([a-z|A-Z]+)/)[1].toLowerCase()},e.utils.options=function(b){if(a.isPlainObject(b))return b;var c=b?b.indexOf("{"):-1,d={};if(-1!=c)try{d=new Function("","var json = "+b.substr(c)+"; return JSON.parse(JSON.stringify(json));")()}catch(e){}return d},String.prototype.hashCode=function(){if(Array.prototype.reduce)return this.split("").reduce(function(a,b){return a=(a<<5)-a+b.charCodeAt(0),a&a},0);var a=0;if(0===this.length)return a;for(var b=0;b<this.length;b++){var c=this.charCodeAt(b);a=(a<<5)-a+c,a&=a}return a},e.assets={},e.assets._ress={},e.assets.load=function(b,c,d){var f=[];b=a.isArray(b)?b:[b];for(var g=0,h=b.length;h>g;g++)b[g]&&(e.assets._ress[b[g]]||(e.assets._ress[b[g]]=b[g].match(/\.js$/)?e.assets.getScript(e.url.get("root:"+b[g])):e.assets.getCss(e.url.get("root:"+b[g]))),f.push(e.assets._ress[b[g]]));return a.when.apply(a,f).done(c).fail(function(){d?d():a.error("Require failed: \n"+b.join(",\n"))})},e.assets.getScript=function(b,d){var e=a.Deferred(),f=c.createElement("script");return f.async=!0,f.onload=function(){e.resolve(),d&&d(f)},f.onerror=function(){e.reject(b)},f.onreadystatechange=function(){("loaded"==this.readyState||"complete"==this.readyState)&&(e.resolve(),d&&d(f))},f.src=b,c.getElementsByTagName("head")[0].appendChild(f),e.promise()},e.assets.getCss=function(b,d){var e=a.Deferred(),f=c.createElement("link");f.type="text/css",f.rel="stylesheet",f.href=b,c.getElementsByTagName("head")[0].appendChild(f);var g=c.createElement("img");return g.onerror=function(){e.resolve(),d&&d(f)},g.src=b,e.promise()},a.zlux=e,a.fn.zx=e.fn,void a(c).on("uk-domready",function(){a("body > .uk-datepicker, body > .uk-timepicker, body > .uk-tooltip").wrap('<div class="zlux" />')}))}(jQuery,window,document),function(a,b){"use strict";b.components={},b.component=function(c,d){var e=function(b,d){var f=this;this.element=b?a(b):null,this.options=a.extend(!0,{},this.defaults,d),this.plugins={},this.element&&this.element.data(c,this),this.init(),(this.options.plugins.length?this.options.plugins:Object.keys(e.plugins)).forEach(function(a){e.plugins[a].init&&(e.plugins[a].init(f),f.plugins[a]=!0)}),this.trigger("init",[this])};return e.plugins={},a.extend(!0,e.prototype,{defaults:{plugins:[]},init:function(){},on:function(){return a(this.element||this).on.apply(this.element||this,arguments)},one:function(){return a(this.element||this).one.apply(this.element||this,arguments)},off:function(b){return a(this.element||this).off(b)},trigger:function(b,c){return a(this.element||this).trigger(b,c)},find:function(b){return this.element?this.element.find(b):a([])},proxy:function(a,b){var c=this;b.split(" ").forEach(function(b){c[b]||(c[b]=function(){return a[b].apply(a,arguments)})})},mixin:function(a,b){var c=this;b.split(" ").forEach(function(b){c[b]||(c[b]=a[b].bind(c))})}},d),this.components[c]=e,this[c]=function(){var d,e;if(arguments.length)switch(arguments.length){case 1:"string"==typeof arguments[0]||arguments[0].nodeType||arguments[0]instanceof jQuery?d=a(arguments[0]):e=arguments[0];break;case 2:d=a(arguments[0]),e=arguments[1]}return d&&d.data(c)?d.data(c):new b.components[c](d,e)},e},b.plugin=function(a,b,c){this.components[a].plugins[b]=c}}(jQuery,jQuery.zlux,window,document),function(a,b,c,d,e){"use strict";b.ajax={},b.ajax.request=function(c){var d={success:!1,errors:[],notices:[]},f=c.queue?c.queue:null,g=null;return delete c.queue,c=a.extend({dataType:"json",type:"POST"},c),a.Deferred(function(h){g=f?b.ajax.queue(f,c):a.ajax(c),g.done(function(c){if("object"!==b.utils.typeOf(c))try{json=a.parseJSON(c)}catch(f){d.errors.push(String(c)),d.errors.push("An server-side error occurred. "+String(f)),h.reject(d)}else c.success===e?(c.errors=["Response format error: status not specified"],h.reject(c)):c.success?h.resolve(c):h.reject(c)}).fail(function(a,b,c){switch(a.status){case 0:break;case 403:d.errors.push("The session has expired.");break;case 404:d.errors.push("The requested URL is not accesible.");break;case 500:d.errors.push("A server-side error has occurred.");break;default:d.errors.push("An error occurred: "+b+"\n Error: "+c)}d.status=a.status,h.reject(d)})}).promise()},b.ajax.requestAndNotify=function(c,d){return d=d===e?{}:d,b.ajax.request(c).done(function(c){d.group&&b.notify.closeAll(d.group),c.message&&b.notify(c.message,a.extend({status:"success"},d))}).fail(function(c){d.group&&a.UIkit.notify.closeAll(d.group),c.errors&&c.errors.length&&a.each(c.errors,function(){b.notify(this,a.extend({status:"danger"},d))}),c.notices&&c.notices.length&&a.each(c.notices,function(){b.notify(this,a.extend({status:"warning"},d))})})};var f={};b.ajax.queue=function(b,d){function e(a){f[b]?f[b].push(a):(f[b]=[],a())}function g(){if(f[b]){var a=f[b].shift();a?a():delete f[b]}}if("undefined"==typeof d)throw"AjaxQ: queue name is not provided";var h=a.Deferred(),i=h.promise();i.success=i.done,i.error=i.fail,i.complete=i.always;var j=a.extend(!0,{},d);return e(function(){var b=a.ajax.apply(c,[j]).always(g);b.done(function(){h.resolve.apply(this,arguments)}),b.fail(function(){h.reject.apply(this,arguments)})}),i},a.each(["getq","postq"],function(c,d){a[d]=function(c,f,g,h,i){return a.isFunction(g)&&(i=i||h,h=g,g=e),b.ajax.queue(c,{type:"postq"===d?"post":"get",url:f,data:g,success:h,dataType:i})}});var g=function(a){return f.hasOwnProperty(a)},h=function(){for(var a in f)if(g(a))return!0;return!1};b.ajax.queue.isRunning=function(a){return a?g(a):h()},b.ajax.queue.clear=function(a){if(a)f[a]&&delete f[a];else for(var b in f)f.hasOwnProperty(b)&&delete f[b]}}(jQuery,jQuery.zlux,window,document),function(a,b){"use strict";var c=function(b,c){var d=a.UIkit.notify(b,c);return a(".uk-notify").wrap('<div class="zlux" />'),d},d=function(c,d){return a.extend({},d,{timeout:!1}),a.Deferred(function(a){var e=b.notify(c+'<div class="uk-text-center uk-margin-top">                    <a class="zx-x-confirm uk-margin-right"><i class="uk-icon-check uk-icon-small"></i></a>                    <a class="zx-x-cancel uk-margin-left"><i class="uk-icon-times uk-icon-small"></i></a>                </div>',d);e.element.on("click",".zx-x-confirm",function(){a.resolve()}),e.element.on("click",function(){a.reject()})}).promise()},e=function(b,c){a.UIkit.notify.closeAll(b,c)};b.notify=c,b.notify.confirm=d,b.notify.closeAll=e}(jQuery,jQuery.zlux,window,document),function(a,b){"use strict";b.component("spin",{defaults:{"class":"",affix:"append"},init:function(){},on:function(){var b=this;b.icon_class=!1,a("i",b.element)[0]?(b.icon_class=a("i",b.element).attr("class"),a("i",b.element).attr("class","uk-icon-spinner uk-icon-spin")):"replace"==b.options.affix?b.element.html(a('<i class="uk-icon-spinner uk-icon-spin"></i>').addClass(b.options["class"])):b.element[b.options.affix](a('<i class="uk-icon-spinner uk-icon-spin"></i>').addClass(b.options["class"]))},off:function(){var b=this;a("i",b.element).removeClass("uk-icon-spinner uk-icon-spin"),b.icon_class&&a("i",b.element).attr("class",b.icon_class)}})}(jQuery,jQuery.zlux,window,document),function(a,b,c,d,e){"use strict";var f;b.components.manager={id:0,init:function(){},getResource:function(a){return a instanceof jQuery?a.data("managerResource"):a},preResourceDelete:function(){},deleteResource:function(c){var d=this,e={url:a.zlux.url.ajax("zlux","deleteResource"),data:{type:d.type}};this.preResourceDelete(c,e),b.ajax.request(e).done(function(){c.element.fadeOut("slow",function(){a(this).remove(),d.trigger("resourceDeleted",c)})}).fail(function(){}).always(function(){})},initResources:function(c){var d=this;return c=c===e?d.find(".zx-manager-resources"):c,b.assets.load(b.url.get("zlux:js/addons/datatables.min.js")).done(function(){b.datatables(),d.resources=c.dataTable(a.extend(!0,{},b.datatables.settings,d.DTsettings)).DataTable(),d.resources.on("click",".zx-x-details-btn",function(){var b=a(this),c=b.closest(".zx-manager-resource"),d=a(".zx-x-details",c);c.hasClass("zx-open")?(b.addClass("uk-icon-angle-down").removeClass("uk-icon-angle-up"),c.removeClass("zx-open"),d.slideUp("fast",function(){})):(c.addClass("zx-open"),b.removeClass("uk-icon-angle-down").addClass("uk-icon-angle-up"),d.slideDown("fast",function(){}))}),d.resources.on("click",".zx-manager-resource .zx-x-name a",function(b){b.preventDefault(),d.trigger("resourceSelected",d.getResource(a(this).closest(".zx-manager-resource")))}),d.resources.on("click",".zx-manager-resource .zx-x-remove",function(c){c.preventDefault();var e=d.getResource(a(this).closest(".zx-manager-resource"));b.notify.confirm(b.lang._("DELETE_THIS_RESOURCE"),{timeout:!1}).done(function(){d.deleteResource(e)})})})},DTsettings:{serverSide:!0}},b.component("managerResource",{data:{editable:!1},defaults:{template:'<div class="zx-x-tools">                                <i class="zx-x-details-btn uk-icon-angle-down" />                                {{#editable}}                                <i class="zx-x-remove uk-icon-minus-circle" data-uk-tooltip title="'+b.lang._("DELETE")+'" />                                {{/some}}                            </div>                            <div class="zx-x-name"><a href="#" class="zx-x-name-link">{{name}}</a></div>                            {{#details && details.length}}                            <div class="zx-x-details">                                <div class="zx-x-messages" />                                <div class="zx-x-details-content">                                    <ul class="uk-list">                                        {{~details}}                                        <li>{{$item}}</li>                                        {{/details}}                                        </ul>                                </div>                            </div>                            {{/end}}'},init:function(){},render:function(){return a.UIkit.Utils.template(this.options.template,this.data)},pushData:function(b){this.data=a.extend({},this.data,b)}}),b.component("managerNav",{defaults:{template:'<ul class="uk-navbar-nav">                                <li class="uk-parent" data-uk-dropdown>                                    <a href=""><i class="uk-icon-bars"></i></a>                                    <div class="uk-dropdown uk-dropdown-navbar">                                        <ul class="uk-nav uk-nav-navbar">                                            <li><a href="">Another item</a></li>                                        </ul>                                    </div>                                </li>                            </ul>                            <div class="uk-navbar-content">                                <form class="uk-form uk-margin-remove uk-display-inline-block">                                   <input type="text" placeholder="Search">                                </form>                            </div>',option_tmpl:'<li><a href=""><i class="uk-icon-{{icon}}"></i> Some text </a></li>'},init:function(){this.element.append(this.options.template)},addChild:function(b){this.find(".uk-dropdown > ul").append(a.UIkit.Utils.template(this.options.option_tmpl,b))}}),b.components.managerDropdown=a.extend(!0,{},b.components.manager,{defaults:{init_display:"",offsettop:5,template:function(){var a="";return a+='<div class="zx-manager-nav">',a+='<div class="uk-search">',a+='<input class="uk-search-field" type="search" placeholder="search...">',a+='<button class="uk-search-close" type="reset"></button>',a+="</div>",a+="</div>",a+='<table class="uk-table zx-manager-resources"></table>'}},init:function(){this.current=this.element.val(),this.hidden=this.element.clone().attr("type","hidden").removeAttr("data-zx-itempicker").insertAfter(this.element),this.element.val(this.options.init_display).removeAttr("name"),this.on("focus",function(){a(".uk-search-field",f).focus()})},initDropdown:function(b){var c=this;if(!b){b=a('<div class="uk-dropdown zx-manager"></div>');var d=null;b.on("keyup",".uk-search-field",function(e){var f=a(this).val();""===f?a(".uk-search-close",b).hide():a(".uk-search-close",b).show(),clearTimeout(d),""===f&&c.resources.search("").draw();var g=e.keyCode?e.keyCode:e.which;return 13==g?void c.resources.search(f).draw():void(d=setTimeout(function(){c.resources.search(f).draw()},500))}),b.on("click",".uk-search-close",function(){a(".uk-search-field",b).val(""),a(this).hide(),c.resources.search("").draw()}),b.appendTo("body"),b.wrap('<div class="zlux" />')}return this.dropdown=b,b},pick:function(b){var d=this.element.offset(),e={top:d.top+this.element.outerHeight()+this.options.offsettop,left:d.left,right:""};this.current=b?b:null,this.inititem=this.current,this.update(),"right"==a.UIkit.langdirection&&(e.right=c.innerWidth-(e.left+this.element.outerWidth()),e.left=""),this.dropdown.css(e).show(),a(".uk-search-field",f).focus()},update:function(){var b=this,c={},d=this.options.template(c,this.options);this.dropdown.html(d),this.initResources(a(".zx-manager-resources",this.dropdown)).done(function(){b.on("resourceSelected",function(a,c){b.element.val(c.data.name),b.hidden.val(c.data.id)})})}})}(jQuery,jQuery.zlux,window,document),function(a,b,c,d){"use strict";var e,f=0,g=!1,h={},i={defaults:{apps:"",types:"",categories:"",tags:"",authors:""},init:function(){var c=this;b.components.manager.init.apply(this),this.id=f++,c.filter={},this.DTsettings.ajax=function(a,b,d){c.ajax(a,b,d)},a.extend(c.DTsettings.language,{emptyTable:b.lang._("IM_NO_ITEMS_FOUND"),info:b.lang._("IM_PAGINATION_INFO")})},DTsettings:{pageLength:5,columns:[{title:"",data:"_itemname","class":"zx-manager-resource-name uk-width-1-1",render:function(a,b){return"display"===b?"":a}}],initComplete:function(){},rowCallback:function(c,d){var e=d;e.details=[],e.details.push(d.application.name+" / "+d.type.name+" / "+d.id),e.details.push(d.created),d.author.name&&e.details.push({name:$this._("AUTHOR"),value:d.author.name});var f=b.managerResource(c,e);f.pushData(e),f.element.addClass("zx-manager-resource"),a(".zx-manager-resource-name",f.element).html("").append(f.render())},preDrawCallback:function(){},drawCallback:function(){}},ajax:function(c,d){{var e=this,f=e.filter.apps?e.filter.apps:e.options.apps,g=e.filter.types?e.filter.types:e.options.types,i=e.filter.cats?e.filter.cats:e.options.categories,j=e.filter.tags?e.filter.tags:e.options.tags;e.filter.authors?e.filter.authors:e.options.authors}c.apps=e.options.apps,c.types=e.options.types,c.categories=e.options.categories,c.tags=e.options.tags,c.authors=e.options.authors,c.filter_apps=f,c.filter_types=g,c.filter_cats=i,c.filter_tags=j,c.zlux2=!0;var k=c.draw;c.draw=0;var l=String(a.param(c)).hashCode();c.draw=k,b.ajax.requestAndNotify({url:b.url.get("ajax:",{controller:"zlux",task:"getItemsManagerData"}),data:c,queue:"itemsmanager"}).done(function(a){h[l]=a,d(a)})},reload:function(){var a=this;a.resources.DataTable().ajax.reload()},preResourceDelete:function(){}};b.component("itempicker",a.extend(!0,{},i,b.components.managerDropdown,{init:function(){var a=this;i.init.apply(this),b.components.managerDropdown.init.apply(this),this.on("click",function(){g!==a&&a.pick(this.value)}),e=this.initDropdown(e).addClass("zx-itempicker")},DTsettings:{ordering:!1,columns:[{title:"",data:"_itemname","class":"zx-x-main-column uk-width-1-1",render:function(a,b){return"display"===b?"":a}}],rowCallback:function(c,d){var e=d;e.details=[],e.details.push(d.application.name+" / "+d.type.name+" / "+d.id);var f=b.managerResource(c,e);f.pushData(e),f.element.addClass("zx-manager-resource"),a(".zx-x-main-column",f.element).append(f.render())}},pick:function(a){b.components.managerDropdown.pick.apply(this,[a]),g=this}})),a(d).on("focus.itempicker.zlux","[data-zx-itempicker]",function(c){var d=a(this);if(!d.data("itempicker")){c.preventDefault();{b.itempicker(d,a.UIkit.Utils.options(d.attr("data-zx-itempicker")))}d.trigger("focus")}}),a(d).on("click.itempicker.zlux",function(b){var c=a(b.target);!g||c[0]==e[0]||c.data("itempicker")||c.parents(".zx-itempicker:first").length||(e.hide(),g=!1)}),a(d).on("uk-domready",function(){a("[data-zx-itempicker]").each(function(){var c=a(this);if(!c.data("itempicker")){b.itempicker(c,a.UIkit.Utils.options(c.attr("data-zx-itempicker")))}})})}(jQuery,jQuery.zlux,window,document);