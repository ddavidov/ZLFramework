/* ===================================================
 * ZLUX
 * https://zoolanders.com
 * ===================================================
 * Copyright (C) JOOlanders SL 
 * http://www.gnu.org/licenses/gpl-2.0.html GNU/GPLv2 only
 * ========================================================== */
(function(a){var e=function(c){this.options=a.extend({},this.options,c);this.events={}};e.prototype=a.extend(e.prototype,{name:"zluxMain",options:{},events:{},JRoot:location.href.match(/^(.+)administrator\/index\.php.*/i)[1],initialize:function(c,d){this.options=a.extend({},this.options,d)},trigger:function(c){var a=this.events[c.toLowerCase()],b,f;if(a){f=Array.prototype.slice.call(arguments);f[0]=this;for(b=0;b<a.length;b++)if(!1===a[b].func.apply(a[b].scope,f))return!1}return!0},bind:function(c,
a,b){var f;c=c.toLowerCase();f=this.events[c]||[];f.push({func:a,scope:b||this});this.events[c]=f},unbind:function(c,a){c=c.toLowerCase();var b=this.events[c],f;if(b){if(a!==undef)for(f=b.length-1;0<=f;f--){if(b[f].func===a){b.splice(f,1);break}}else b=[];b.length||delete this.events[c]}},unbindAll:function(){var a=this;plupload.each(events,function(d,b){a.unbind(b)})},hasEventListener:function(a){return!!this.events[a.toLowerCase()]},sprintf:function(a){var d=[].slice.call(arguments,1),b="";a.split(/%[sdf]/).forEach(function(a){b+=
a;d.length&&(b+=d.shift())});return b}});a.zluxMain=e})(jQuery);
(function(a){var e=function(c){this.options=a.extend({},this.options,c);this.events={}};e.prototype=a.extend(e.prototype,a.zluxMain.prototype,{name:"zluxDialog",options:{width:"300",height:"150",title:"Dialog"},events:{},init:function(){var c=this;c.inited||(c.options.dialogClass="zlux-dialog "+c.options.dialogClass,c.main=a("<div />").appendTo(a("body")).dialog(a.extend({autoOpen:1,resizable:!1,height:"auto"},c.options)),c.content=a('<div class="zlux-dialog-content" />').appendTo(c.main),c.widget=
c.main.dialog("widget"),c.main.on("dialogopen",function(){c.widget.data("dialog-dragged")||c.widget.position(a.extend({my:"center",at:"center",of:window},c.options.position)).data("dialog-dragged",1)}),c._spinner=a('<span class="zlux-loader-circle-big" />').appendTo(c.widget),c._spinner_area=c.main,c.main.perfectScrollbar(),c.toolbar={},c.toolbar.wrapper=a('<div class="zlux-dialog-toolbar" />').hide().insertAfter(c.widget.children()[0]),c.trigger("InitComplete"),c.inited=!0)},toggle:function(){this.dialog(this.dialog("isOpen")?
"close":"open")},dialog:function(a){return this.main.dialog(a)},scrollbar:function(c){"refresh"==c?(a(".ps-scrollbar-y",this.main).css("top",0),a(".ps-scrollbar-x",this.main).css("left",0),this.scrollbar("show"),this.scrollbar("update"),c=this.content.width()-a(".ps-scrollbar-x",this.main).width(),0<=c&&5>=c&&this.scrollbar("hide")):"hide"==c?this.widget.addClass("noscroll"):"show"==c?this.widget.removeClass("noscroll"):this.main.perfectScrollbar(c)},spinner:function(a){"show"==a?(this.inited&&this.main.add().fadeTo(0,
0.5),this._spinner.show()):(this._spinner.hide(),this.main.add(this.toolbar.wrapper).fadeTo("slow",1),this.spinner_inited||(this._spinner.appendTo(this.content),this.spinner_inited=!0))},newToolbar:function(c,d,b){var f=a('<ul class="zlux-dialog-toolbar-'+d+' inline" />').appendTo(this.toolbar.wrapper);a.each(c,function(b,c){f.append(a("<li />").append(a('<i class="icon-'+c.icon+' icon-2x icon-border" title="'+c.title+'">'+(c.subicon?'<i class="icon-'+c.subicon+'"></i>':"")+"</i>").on("click",function(){if(a(this).hasClass("disabled"))return!1;
c.click(a(this))})))});a(".zlux-dialog-toolbar-backtomain",this.toolbar.wrapper).on("click",function(){b()})},newSubToolbar:function(c){a('<div class="zlux-dialog-subtoolbar-'+c+'" />').hide().appendTo(this.toolbar.wrapper)},setMainToolbar:function(c){var d=this;d.newToolbar(c,"main");d.toolbar.wrapper.prepend(a('<i class="zlux-dialog-toolbar-backtomain icon-reply icon-border" title="Back to Main view" />').on("click",function(){a('[class^="zlux-dialog-toolbar-"]',d.toolbar.wrapper).hide();a(".zlux-dialog-toolbar-main",
d.toolbar.wrapper).show()}))},showToolbar:function(c){a(".zlux-dialog-toolbar-"+c,this.toolbar.wrapper).show();a(".zlux-dialog-toolbar-main",this.toolbar.wrapper).hide();a(".zlux-dialog-toolbar-backtomain",this.toolbar.wrapper).show()},toolbarBtnState:function(c,d,b){var f=a(".zlux-dialog-toolbar-"+c+" i.icon-"+d,this.toolbar.wrapper);"disabled"==b?f.animate({color:"#C0C0C0"},200,function(){f.addClass("disabled")}):f.animate({color:"#444"},200,function(){f.removeClass("disabled")})}});a.zluxDialog=
e})(jQuery);
(function(a){var e=function(c){this.options=a.extend({},this.options,c);this.events={}};e.prototype=a.extend(e.prototype,a.zluxMain.prototype,{name:"zluxItemsManager",options:{apps:"",types:"",categories:"",tags:"",ajax_url:""},initialize:function(c,d){this.options=a.extend({},this.options,d);var b=this;b.filter={};b.target=c;b.itemsmanager=a('<div class="zl-bootstrap zlux-itemsmanager" />');button=null;"INPUT"==c[0].tagName?(c.wrap(b.itemsmanager),button=a('<a title="'+b.options.title+'" class="btn btn-mini zlux-btn-edit" href="#"><i class="icon-edit"></i></a>').insertAfter(c)):
(a("<div />").appendTo(b.itemsmanager),button=a('<a class="btn btn-mini" href="#"><i class="icon-plus-sign"></i>Add Item</a>').appendTo(b.itemsmanager),b.itemsmanager.appendTo(c));button.zluxSelector({title:b.options.title,width:b.options.full_mode?"75%":300,height:"auto",dialogClass:"zl-bootstrap zlux-items-manager-dialog "+(b.options.full_mode?"zlux-dialog-full":"zlux-dialog-mini"),position:b.options.full_mode?{my:"center",at:"center",of:window}:null,button:button},function(a){b.zluxSelector=a;
b._dataTable(a.content,function(){b.zluxSelector.scrollbar()})});b.bind("ItemSelected",function(){b._addReleatedItem(wrapper.children("div"),col)})},_addReleatedItem:function(c){c=this.oTable.fnGetData(c[0]);c=a('<div class="row-fluid" />').append(a('<span class="span12"><h4>'+c._itemname+"</h4><div>"+c.details+"</div></span>"));this.wrapper.append(c)},initDataTable:function(c){var d=this;a.extend(a.fn.dataTableExt.oStdClasses,{sWrapper:"dataTables_wrapper form-horizontal"});a('<table cellpadding="0" cellspacing="0" border="0" class="table table-striped table-bordered" />').appendTo(c);
d.oTable=a("table",c).dataTable({sDom:"f<'row-fluid'<'span12't>><'row-fluid'<'span12'p>><'row-fluid'<'span12'i>>",bServerSide:!0,iDisplayLength:5,sAjaxSource:d.options.ajax_url+"&task=ItemsManager",fnServerParams:function(b){var a=d.filter.apps?d.filter.apps:d.options.apps,c=d.filter.types?d.filter.types:d.options.types,e=d.filter.cats?d.filter.cats:d.options.categories;tags=d.filter.tags?d.filter.tags:d.options.tags;b.push({name:"apps",value:d.options.apps});b.push({name:"types",value:d.options.types});
b.push({name:"filter_apps",value:a});b.push({name:"filter_types",value:c});b.push({name:"filter_cats",value:e});b.push({name:"filter_tags",value:tags})},oLanguage:{sSearch:"_INPUT_",sEmptyTable:"No Items found",sInfoEmpty:"",sInfo:"_END_ of _TOTAL_"},aoColumns:[{sTitle:"Name",mData:"_itemname",sWidth:"38%",sClass:"zlux-global-entry",mRender:function(b,a){return"display"==a?'<span class="zlux-global-entry-name"><a href="#">'+b+"</a></span>":b},fnCreatedCell:function(b,c,d){a(b).parent("tr").attr("data-id",
d.id)}},{sTitle:"App",mData:"application",bSortable:!1,mRender:function(b,a){return"display"==a?b.name:b.id}},{sTitle:"Type",mData:"type",bSortable:!1,mRender:function(b,a){return"display"==a?b.name:b.id}},{sTitle:"Access",mData:"access",bSearchable:!1,bSortable:!1},{sTitle:"Author",mData:"author",bSearchable:!1,bSortable:!1,mRender:function(b,a){return"display"==a?b.name:b.id}},{sTitle:"ID",mData:"id",bSearchable:!1,bSortable:!1}],aoColumnDefs:[{bVisible:!1,aTargets:[1,2,3,4,5]}],fnInitComplete:function(){var b=
a(".dataTables_filter",c).append(a('<i class="icon-search" />'),a('<i class="icon-remove zlux-ui-dropdown-unselect" />').hide().on("click",function(){a("input",b).val("");a(this).hide();d.oTable.fnFilter("")}));a("input",b).on("keyup",function(){""==a(this).val()?a(".zlux-ui-dropdown-unselect",b).hide():a(".zlux-ui-dropdown-unselect",b).show()});d.trigger("InitComplete")},fnRowCallback:function(b,c){var d="";a.each(c.details,function(b,a){d+="<li><strong>"+b+"</strong>: "+a+"</li>"});a(".zlux-global-entry",
a(b)).prepend('<i class="zlux-global-entry-toggle icon-check-empty" /><i class="zlux-global-entry-details-btn icon-plus-sign" />').append('<div class="zlux-global-entry-details"><ul class="unstyled">'+d+"</ul></div>")},fnPreDrawCallback:function(b){d.zluxdialog.spinner("show");d.trigger("DTPreDrawCallback",b)},fnDrawCallback:function(b){var c=b.oInstance.fnPagingInfo(),e=a(".dataTables_paginate",a(b.nTableWrapper)).closest(".row-fluid");1>=c.iTotalPages&&e.hide()||e.show();d.zluxdialog.scrollbar("refresh");
d.zluxdialog.spinner("hide");d.trigger("DTDrawCallback",b)}}).on("click",".zlux-global-entry-name a, .zlux-global-entry-toggle",function(b){var c=a(this).closest("tr");"true"!=c.attr("data-zlux-global-entry-status")?(c.attr("data-zlux-global-entry-status","true"),a(".zlux-global-entry-toggle",c).removeClass("icon-check-empty").addClass("icon-check"),d.trigger("ItemSelected",c.data("id"),c)):a(".zlux-global-entry-toggle").is(b.target)&&(c.removeAttr("data-zlux-global-entry-status"),a(".zlux-global-entry-toggle",
c).removeClass("icon-check").addClass("icon-check-empty"),d.trigger("ItemUnselected",c.data("id"),c));return!1}).on("click",".zlux-global-entry-details-btn",function(){var b=a(this),c=b.closest("td"),e=b.siblings(".zlux-global-entry-details");c.hasClass("zlux-ui-open")?e.slideUp("fast",function(){c.removeClass("zlux-ui-open");b.addClass("icon-plus-sign").removeClass("icon-minus-sign");d.zluxdialog.scrollbar("refresh")}):(c.addClass("zlux-ui-open"),e.slideDown("fast",function(){b.removeClass("icon-plus-sign").addClass("icon-minus-sign");
d.zluxdialog.scrollbar("refresh")}))})},reload:function(){this.oTable.fnReloadAjax()}});a.fn[e.prototype.name]=function(){var c=arguments,d=c[0]?c[0]:null;return this.each(function(){var b=a(this);if(e.prototype[d]&&b.data(e.prototype.name)&&"initialize"!=d)b.data(e.prototype.name)[d].apply(b.data(e.prototype.name),Array.prototype.slice.call(c,1));else if(!d||a.isPlainObject(d)){var f=new e;e.prototype.initialize&&f.initialize.apply(f,a.merge([b],c));b.data(e.prototype.name,f)}else a.error("Method "+
d+" does not exist on jQuery."+e.name)})};a.zluxItemsManager=e})(jQuery);
(function(a){var e=function(c){this.options=a.extend({},a.zluxItemsManager.prototype.options,this.options,c);this.events={}};e.prototype=a.extend(e.prototype,a.zluxItemsManager.prototype,{name:"zluxDialogItemsManager",options:{title:"Items Manager",full_mode:0},events:{},initialize:function(c,d){this.options=a.extend({},this.options,d);var b=this;b.filter={};b.wrapper=c.wrap(a('<div class="zl-bootstrap" />'));var f=a('<a title="'+b.options.title+'" class="btn btn-mini zlux-btn-edit" href="#"><i class="icon-edit"></i></a>').insertAfter(c).on("click",
function(){b.zluxdialog.inited?b.zluxdialog.toggle():b.zluxdialog.init();return!1});b.zluxdialog=new a.zluxDialog({title:b.options.title,width:b.options.full_mode?"75%":300,dialogClass:"zl-bootstrap zlux-itemsmanager-dialog "+(b.options.full_mode?"zlux-dialog-full":"zlux-dialog-mini"),position:!1==b.options.full_mode?{of:f,my:"left top",at:"right bottom"}:null});b.zluxdialog.bind("InitComplete",function(){b.itemsmanager=a('<div class="zlux-itemsmanager" />').appendTo(b.zluxdialog.content);b.initDataTable(b.itemsmanager);
a("html").on("mousedown",function(a){b.zluxdialog.dialog("isOpen")&&!f.is(a.target)&&!f.find(a.target).length&&!b.zluxdialog.widget.find(a.target).length&&!b.zluxdialog.widget.is(a.target)&&b.zluxdialog.dialog("close")});b.zluxdialog.setMainToolbar([{title:"Apply Filters",icon:"filter",click:function(c){a(".zlux-dialog-subtoolbar-filter",b.zluxdialog.toolbar.wrapper).slideToggle("fast");c.toggleClass("zlux-ui-tool-enabled")}},{title:"Refresh",icon:"refresh",click:function(){b.reload()}}]);b.zluxdialog.newSubToolbar("filter")});
b.bind("InitComplete",function(){b.zluxdialog.scrollbar("refresh");var c=a(".zlux-dialog-subtoolbar-filter",b.zluxdialog.toolbar.wrapper);c.append(b.getSelect("aaApps","Filter by App",function(d){b.filter.apps=d;b.filter.types="";a(".btn-group[data-id=2]",c).attr("data-update",!0)},function(){b.filter.apps=""}),b.getSelect("aaTypes","Filter by Type",function(d){b.filter.types=d;a(".btn-group[data-id=2]",c).attr("data-update",!1)},function(){b.filter.types=""}),b.getSelect("aaCategories","Filter by Category",
function(a){b.filter.cats=a},function(){b.filter.cats=""}),b.getSelect("aaTags","Filter by Tag",function(a){b.filter.tags=a},function(){b.filter.tags=""}));a(".dataTables_filter",b.oTable.fnSettings().nTableWrapper).appendTo(c);b.zluxdialog.spinner("hide")});b.bind("ItemSelected",function(b,a,d){d.siblings("[data-checked]").removeAttr("data-checked");c.val(a).trigger("change")});b.bind("ItemUnselected",function(){c.val("").trigger("change")})},getSelect:function(c,d,b,f){var e=this,l=a.parseJSON(e.oTable.fnSettings().jqXHR.responseText)[c],
g=a('<a class="btn dropdown-toggle" data-toggle="dropdown" href="#">'+d+'<span class="caret" /></a>'),h=a('<ul class="dropdown-menu">'+e._getSelectOptions(l)+"</ul>"),j=a('<div class="btn-group" data-text="'+d+'" />').append(g,h),m=a('<i class="icon-remove zlux-ui-dropdown-unselect" />').on("click",function(){g.html(d+'<span class="caret"></span>');m.hide();a.isFunction(f)&&f();e.reload()}).hide().prependTo(j);l.length||g.addClass("disabled");g.on("click",function(){if(g.hasClass("disabled"))return!1});
h.on("click","a",function(c){var f=a(this).data("value")?a(this).data("value"):"",l=d,l=a(this).text().replace(/^[^a-zA-Z]+/g,"").replace(/[^a-zA-Z]+$/g,"");m.show();g.html(l+'<span class="caret"></span>').data("selected-value",f);a.isFunction(b)&&b(f);e.reload();c.preventDefault()});e.bind("DTDrawCallback",function(){var b=a.parseJSON(e.oTable.fnSettings().jqXHR.responseText)[c];h.empty().append(e._getSelectOptions(b));b.length||j.addClass("disabled");var f=!1;a.each(b,function(b,a){a.id==g.data("selected-value")&&
(f=!0)});f||(m.hide(),g.data("selected-value","").html(d+'<span class="caret"></span>'))});return j},_getSelectOptions:function(a){var d,b=a.length,f=[];for(d=0;d<b;d++){var e='<li><a href="#" data-value="'+a[d].id+'">'+a[d].name+"</a></li>";-1<jQuery.inArray(e,f)||f.push(e)}return f.join("")}});a.fn[e.prototype.name]=function(){var c=arguments,d=c[0]?c[0]:null;return this.each(function(){var b=a(this);if(e.prototype[d]&&b.data(e.prototype.name)&&"initialize"!=d)b.data(e.prototype.name)[d].apply(b.data(e.prototype.name),
Array.prototype.slice.call(c,1));else if(!d||a.isPlainObject(d)){var f=new e;e.prototype.initialize&&f.initialize.apply(f,a.merge([b],c));b.data(e.prototype.name,f)}else a.error("Method "+d+" does not exist on jQuery."+e.name)})}})(jQuery);
(function(a){var e=function(c){this.options=a.extend({},this.options,c);this.events={}};e.prototype=a.extend(e.prototype,a.zluxMain.prototype,{name:"zluxFilesManager",options:{root:"images",extensions:"",ajax_url:""},events:{},initialize:function(c,d){this.options=a.extend({},this.options,d);this.target=c;this.filesmanager=a('<div class="zl-bootstrap zlux-filesmanager" />').appendTo(c);this.initDataTable(this.filesmanager)},initDataTable:function(c){var d=this,b=d.options.ajax_url+"&task=FilesManager&root="+
d.options.root;a.extend(a.fn.dataTableExt.oStdClasses,{sWrapper:"dataTables_wrapper form-horizontal"});a('<table cellpadding="0" cellspacing="0" border="0" class="table table-striped table-bordered" />').appendTo(c);d.oTable=a("table",c).dataTable({sDom:"<'row-fluid'<'span12'B>><'row-fluid'<'span12'f>><'row-fluid'<'span12't>><'row-fluid row-footer'<'span6'i><'span6'p>>",oLanguage:{sSearch:"_INPUT_",sEmptyTable:"No Files found",sInfoEmpty:"",sInfo:"Showing _END_ of _TOTAL_ Files"},sAjaxUrl:d.options.ajax_url,
sAjaxSource:b,sServerMethod:"POST",sStartRoot:d.options.root,iDisplayLength:9,aoColumns:[{sTitle:"",mData:"type",bSearchable:!1,sWidth:"14px",sClass:"column-icon",mRender:function(b,a){return"display"==a?'<i class="icon-'+("folder"==b?"folder-close":"file-alt")+'"></i>':b}},{sTitle:"Name",mData:"name",sClass:"column-name",mRender:function(b,a){return"display"==a?'<a href="#">'+b+"</a>":b},fnCreatedCell:function(b,c,d){a(b).parent("tr").attr("data-path",d.path)}}],aoColumnDefs:{bVisible:!1,aTargets:[2]},
aaSorting:[[0,"desc"],[1,"asc"]],fnServerData:function(b,a,c,e){d._fnServerData(b,a,c,e)},fnServerParams:function(b){b.push({name:"extensions",value:d.options.extensions})},fnRowCallback:function(b,c){a(b).attr("data-type",c.type)},fnInitComplete:function(){var b=a(".dataTables_filter",c).append(a('<i class="icon-search" />'),a('<i class="icon-remove zlux-ui-dropdown-unselect" />').hide().on("click",function(){a("input",b).val("");a(this).hide();d.oTable.fnFilter("")}));a("input",b).on("keyup",function(){""==
a(this).val()?a(".zlux-ui-dropdown-unselect",b).hide():a(".zlux-ui-dropdown-unselect",b).show()});d.trigger("InitComplete")},fnPreDrawCallback:function(){d.zluxdialog.spinner("show")},fnDrawCallback:function(b){var c=b.oInstance.fnPagingInfo(),e=a(".dataTables_paginate",a(b.nTableWrapper)).closest(".row-fluid");1>=c.iTotalPages&&e.hide()||e.show();d.zluxdialog.scrollbar("refresh");b.sCurrentRoot&&d.zluxdialog.spinner("hide")}}).on("click","tbody [data-type=folder] a",function(){var b=a(this).closest("tr"),
c=d.oTable.fnSettings(),e=c.sAjaxSource.replace(/\&root=.+/,"");d.oTable.fnReloadAjax(e+"&root="+c.sCurrentRoot+"/"+b.data("path"));return!1}).on("click","tbody [data-type=file] a",function(){a(this).closest("tr").attr("data-checked","true");a(this).closest("td");d.oTable.fnSettings();return!1}).on("click","tbody [data-type=file] .icon-remove",function(){a(this).closest("tr").removeAttr("data-checked");a(this).closest("td");return!1})},reload:function(){$this.oTable.fnSettings().bReloading=!0;$this.oTable.fnReloadAjax($this.oTable.fnSettings().sAjaxSource)},
_fnServerData:function(c,d,b,f){$this=this;f.aAjaxDataCache=f.aAjaxDataCache?f.aAjaxDataCache:[];f.jqXHR=a.ajax({url:c,data:d,beforeSend:function(){var d=!1,e=c.match(/\&root=.+/),e=e?e.pop().replace(/\&root=/,"").replace(/\/$/,""):"";f.bReloading||a.each(f.aAjaxDataCache,function(c,h){if(h.root==e){var j=h.data;f.sCurrentRoot=h.root;a(f.oInstance).trigger("xhr",[f,j]);b(j);d=!0}});if(d)return!1;$this.zluxdialog.spinner("show")},success:function(c){c.sError&&f.oApi._fnLog(f,0,c.sError);f.sCurrentRoot=
c.root;f.bReloading&&(f.aAjaxDataCache=[]);var d=!1;a.each(f.aAjaxDataCache,function(b,a){if(a.root==c.root)return f.aAjaxDataCache[b]={root:c.root,data:c},d=!0,!1});d||f.aAjaxDataCache.push({root:c.root,data:c});f.bReloading=!1;a(f.oInstance).trigger("xhr",[f,c]);b(c)},dataType:"json",cache:!1,type:f.sServerMethod,error:function(b,a){"parsererror"==a&&f.oApi._fnLog(f,0,"DataTables warning: JSON data from server could not be parsed. This is caused by a JSON formatting error.")}})}});a.fn[e.prototype.name]=
function(){if(!this.data(e.prototype.name)){var c=arguments,d=c[0]?c[0]:null;return this.each(function(){var b=a(this);if(e.prototype[d]&&b.data(e.prototype.name)&&"initialize"!=d)b.data(e.prototype.name)[d].apply(b.data(e.prototype.name),Array.prototype.slice.call(c,1));else if(!d||a.isPlainObject(d)){var f=new e;e.prototype.initialize&&f.initialize.apply(f,a.merge([b],c));b.data(e.prototype.name,f)}else a.error("Method "+d+" does not exist on jQuery."+e.name)})}};a.zluxFilesManager=e})(jQuery);
(function(a){var e=function(c){this.options=a.extend({},this.options,c);this.events={}};e.prototype=a.extend(e.prototype,a.zluxFilesManager.prototype,{name:"zluxDialogFilesManager",options:{title:"Files Manager",full_mode:0},events:{},initialize:function(c,d){this.options=a.extend({},a.zluxFilesManager.prototype.options,this.options,d);var b=this;b.wrapper=c.wrap(a('<div class="zl-bootstrap" />'));var e=a('<a title="'+b.options.title+'" class="btn btn-mini zlux-btn-edit" href="#"><i class="icon-edit"></i></a>').insertAfter(c).on("click",
function(){b.zluxdialog.inited?b.zluxdialog.toggle():b.zluxdialog.init();return!1});b.zluxdialog=new a.zluxDialog({title:b.options.title,width:b.options.full_mode?"75%":300,dialogClass:"zl-bootstrap zlux-filesmanager-dialog "+(b.options.full_mode?"zlux-dialog-full":"zlux-dialog-mini"),position:!1==b.options.full_mode?{of:e,my:"left top",at:"right bottom"}:null});b.zluxdialog.bind("InitComplete",function(){b.filesmanager=a('<div class="zlux-filesmanager" />').appendTo(b.zluxdialog.content);b.initDataTable(b.filesmanager);
a("html").on("mousedown",function(a){b.zluxdialog.dialog("isOpen")&&!e.is(a.target)&&!e.find(a.target).length&&!b.zluxdialog.widget.find(a.target).length&&b.zluxdialog.dialog("close")});b.zluxdialog.setMainToolbar([{title:"New folder",icon:"folder-close",subicon:"plus-sign",click:function(){console.log(1)}},{title:"Upload files to current folder",icon:"cloud-upload",click:function(){b.zluxdialog.showToolbar(2);b.zluxdialog.scrollbar("hide");a(".zlux-filesmanager",b.zluxdialog.content).fadeOut("400",
function(){b.zluxupload.inited||b.zluxupload.init();a(".zlux-upload",b.zluxdialog.content).fadeIn("400")})}},{title:"Refresh",icon:"refresh",click:function(){b.reload()}}]);b.zluxupload=new a.zluxUpload({url:b.options.ajax_url+"&task=upload",path:"images",wrapper:b.zluxdialog.content,signature:b.options.signature,policy:b.options.policy});b.zluxupload.bind("QueueChanged",function(){b.zluxdialog.scrollbar("refresh");b.zluxupload.getQueuedFiles().length?b.zluxdialog.toolbarBtnState(2,"upload","enabled"):
b.zluxdialog.toolbarBtnState(2,"upload","disabled")});b.zluxupload.bind("Init",function(){b.zluxupload.uploader.bind("BeforeUpload",function(){b.zluxdialog.toolbarBtnState(2,"ban-circle","enabled");b.zluxdialog.toolbarBtnState(2,"upload","disabled");b.zluxdialog.toolbarBtnState(2,"plus-sign","disabled")});b.zluxupload.uploader.bind("UploadComplete",function(){b.zluxdialog.toolbarBtnState(2,"ban-circle","enabled");b.zluxdialog.toolbarBtnState(2,"plus-sign","enabled");b.zluxdialog.toolbarBtnState(2,
"ban-circle","disabled")})});b.zluxdialog.newToolbar([{title:"Add new files to upload",icon:"plus-sign",click:function(){a(".zlux-upload-browse",b.upload).siblings(".moxie-shim").children("input").trigger("click")}},{title:"Start uploading",icon:"upload disabled",click:function(){b.zluxupload.uploader.start();return!1}},{title:"Cancel current upload",icon:"ban-circle disabled",click:function(){b.zluxupload.uploader.stop();b.zluxdialog.toolbarBtnState(2,"ban-circle","disabled");b.zluxdialog.toolbarBtnState(2,
"upload","enabled");b.zluxdialog.toolbarBtnState(2,"plus-sign","enabled")}}],2,function(){a(".zlux-upload",b.zluxdialog.content).fadeOut("400",function(){b.zluxupload.emptyQueue();a(".zlux-filesmanager",b.zluxdialog.content).fadeIn("400");b.zluxdialog.scrollbar("refresh")})})});b.bind("InitComplete",function(){b.zluxdialog.spinner("hide");b.zluxdialog.scrollbar("refresh")})}});a.fn[e.prototype.name]=function(){var c=arguments,d=c[0]?c[0]:null;return this.each(function(){var b=a(this);if(e.prototype[d]&&
b.data(e.prototype.name)&&"initialize"!=d)b.data(e.prototype.name)[d].apply(b.data(e.prototype.name),Array.prototype.slice.call(c,1));else if(!d||a.isPlainObject(d)){var f=new e;e.prototype.initialize&&f.initialize.apply(f,a.merge([b],c));b.data(e.prototype.name,f)}else a.error("Method "+d+" does not exist on jQuery."+e.name)})}})(jQuery);
(function(a){var e=function(c){this.options=a.extend({},this.options,c);this.events={}};e.prototype=a.extend(e.prototype,a.zluxMain.prototype,{name:"zluxUpload",options:{url:null,extensions:null,path:null,fileMode:"files",max_file_size:"1024kb",wrapper:null},init:function(){var c=this;c.upload=a('<div class="zlux-upload" />').attr("data-zlux-upload-status","").appendTo(c.options.wrapper).hide();c.dropzone=a('<div class="zlux-upload-dropzone" />').appendTo(c.upload).append(a('<span class="zlux-upload-dropzone-msg">Drop files here<br />or <a class="zlux-upload-browse" href="javascript:;">browse & choose</a> them</span>'));
c.initDnDevents();c.bind("WindowDragHoverStart",function(){c.dropzone.attr("data-zlux-draghover",!0)});c.bind("WindowDragHoverEnd",function(){c.dropzone.attr("data-zlux-draghover",!1)});c.filelist=a('<ul class="unstyled zlux-upload-filelist" />').appendTo(c.upload).on("click",".zlux-upload-file-btn-details",function(){var c=a(this),b=c.closest(".zlux-upload-file"),e=c.siblings(".zlux-upload-file-details");b.hasClass("zlux-ui-open")?(c.addClass("icon-plus-sign").removeClass("icon-minus-sign"),e.slideUp("fast",
function(){b.removeClass("zlux-ui-open")})):(b.addClass("zlux-ui-open"),c.removeClass("icon-plus-sign").addClass("icon-minus-sign"),e.slideDown("fast",function(){}))}).on("click",".zlux-upload-file-btn-remove",function(){var d=a(this).closest(".zlux-upload-file"),b=c.uploader.getFile(d[0].id);b.zlux_status!=plupload.STARTED&&b.status!=plupload.UPLOADING&&d.fadeOut(function(){a(this).remove();c.uploader.removeFile(b)})});c.bind("FileError",function(d,b,e){d=a("#"+b.id,c.filelist);d.attr("data-zlux-upload-status",
"error");a(".zlux-upload-file-details-error",d).html(e);a(".zlux-upload-file-btn-details",d).removeClass("icon-minus-sign").addClass("icon-warning-sign")});c.initPlupload();c.inited=!0},initPlupload:function(){var c=this;c.uploader=new plupload.Uploader({runtimes:"html5",browse_button:a(".zlux-upload-browse",c.upload)[0],drop_element:c.dropzone[0],max_file_size:"1mb",url:"http://milcom.testing.s3.amazonaws.com/",multipart:!0,multipart_params:{key:"${filename}",Filename:"${filename}",acl:"public-read",
"Content-Type":"image/jpeg",success_action_status:"201",AWSAccessKeyId:"AKIAJBGAQYDO6Z76KIGQ",policy:c.options.policy,signature:c.options.signature},file_data_name:"file",flash_swf_url:c.JRoot+"media/zoo/applications/docs/elements/contentarea/assets/plupload/Moxie.swf",init:{FilesAdded:function(a,b){c.eventFilesAdded(b)},FileUploaded:function(a,b,e){c.eventFileUploaded(b,e)},UploadProgress:function(a,b){c.eventUploadProgress(b)},BeforeUpload:function(a,b){c.eventBeforeUpload(b)},QueueChanged:function(){c.eventQueueChanged()},
StateChanged:function(){c.eventStateChanged()},Error:function(a,b){c.eventError(b)}}});c.uploader.bind("Init",function(){c.trigger("Init")});c.uploader.init()},_:function(a){return plupload.translate(a)||a},eventError:function(a){var d=a.file,b,e;if(d){b="<strong>"+a.message+"</strong>";if(e=a.details)b+=" <br /><i>"+a.details+"</i>";else{switch(a.code){case plupload.FILE_EXTENSION_ERROR:e=this._("File: %s").replace("%s",d.name);break;case plupload.FILE_SIZE_ERROR:e=this.sprintf(this._("File: %s, size: %d, max file size: %d"),
d.name,d.size,plupload.parseSize(this.options.max_file_size));break;case plupload.FILE_DUPLICATE_ERROR:e=this._("%s already present in the queue.").replace(/%s/,d.name);break;case plupload.FILE_COUNT_ERROR:e=this._("Upload element accepts only %d file(s) at a time. Extra files were stripped.").replace("%d",this.options.max_file_count);break;case plupload.IMAGE_FORMAT_ERROR:e=this._("Image format either wrong or not supported.");break;case plupload.IMAGE_MEMORY_ERROR:e=this._("Runtime ran out of available memory.");
break;case plupload.HTTP_ERROR:e=this._("Upload URL might be wrong or doesn't exist.")}b+=" <br /><i>"+e+"</i>"}this.trigger("FileError",d,b)}},eventStateChanged:function(){this.uploader.state===plupload.UPLOADING&&this.upload.attr("data-zlux-upload-status","uploading");this.uploader.state===plupload.STOPPED&&(this.upload.attr("data-zlux-upload-status","stopped"),a(".zlux-upload-toolbar-progress .bar",this.upload).width("0%"),this._updateFilelist())},eventBeforeUpload:function(c){var d=a("#"+c.id,
this.filelist);a(".zlux-upload-file-progress",d).html("0%");c.zlux_status=2;this._handleFileStatus(c)},eventUploadProgress:function(c){var d=isNaN(c.percent)?0:c.percent;a("#"+c.id+" .zlux-upload-file-progress",this.filelist).html(d+"%");this._handleFileStatus(c)},eventFileUploaded:function(c,d){var b=a.parseJSON(d.response);a("#"+c.id+" .zlux-upload-file-name",this.filelist).html(b.name);a("#"+c.id+" .zlux-upload-file-progress",this.filelist).html("100%").fadeOut();a("#"+c.id+" .zlux-upload-file-btn-remove").removeClass("icon-remove").addClass("icon-ok");
this._handleFileStatus(c)},eventFilesAdded:function(c){var d=this;a.each(c,function(b,a){d._renderFilePreview(a)})},eventQueueChanged:function(){this._updateFilelist()},getQueuedFiles:function(){var c=[];a.each(this.uploader.files,function(a,b){b.status!=plupload.DONE&&c.push(b)});return c},emptyQueue:function(){this.uploader.splice();this.filelist.empty()},_updateFilelist:function(){var c=this,d=!1;a.each(c.uploader.files,function(a,e){e.status!=plupload.DONE&&(d=!0);e.status==plupload.STOPPED&&
c._handleFileStatus(e)});c.uploader.files.length&&a(".zlux-upload-dropzone-msg",c.upload).hide();c.uploader.files.length?d?(c.upload.attr("data-zlux-upload-status","queued"),a(".zlux-upload-toolbar-start",c.upload).removeClass("disabled")):(c.upload.attr("data-zlux-upload-status","stopped"),a(".zlux-upload-toolbar-start",c.upload).addClass("disabled")):(c.upload.attr("data-zlux-upload-status",""),a(".zlux-upload-toolbar-start",c.upload).addClass("disabled"),a(".zlux-upload-dropzone-msg",c.upload).fadeIn());
c.trigger("QueueChanged")},_renderFilePreview:function(c){a('<li id="'+c.id+'" class="zlux-upload-file" />').append(a('<i class="zlux-upload-file-btn-remove icon-remove" />'),a('<i class="zlux-upload-file-btn-details icon-plus-sign" />'),a('<span class="zlux-upload-file-progress"/>'),a('<div class="zlux-upload-file-name">'+c.name+"</div>"),a('<div class="zlux-upload-file-details" />').append('<div class="zlux-upload-file-details-error" /><ul class="unstyled zlux-upload-file-details-list"><li><strong>Name</strong>: '+
c.name.replace(/(\.[a-z0-9]+)$/,"")+"</li><li><strong>Type</strong>: "+c.type+"</li><li><strong>Size</strong>: "+plupload.formatSize(c.size)+"</li></ul>").hide()).appendTo(this.filelist)},_handleFileStatus:function(c){var d=a("#"+c.id,this.filelist),b="";c.zlux_status==plupload.STARTED?(b="started",c.zlux_status=""):(c.status==plupload.DONE&&(b="done"),c.status==plupload.FAILED&&(b="failed"),c.status==plupload.QUEUED&&(b="queued"),c.status==plupload.UPLOADING&&(b="uploading"),c.status==plupload.STOPPED&&
a(".zlux-upload-file-progress",d).html(""));d.attr("data-zlux-upload-status",b)},_updateTotalProgress:function(){a(".progress .bar",this.toolbar).css("width",this.uploader.total.percent+"%")},initDnDevents:function(){var c=this,d=a(),b=a(),e=!1;inDZ=!1;a(window).on("drop",function(a){a.preventDefault();return!1}).on("dragenter",function(a){0===d.size()&&(c.trigger("WindowDragHoverStart"),e=!0,inDZ=!1);d=d.add(a.target)}).on("dragleave drop",function(k){setTimeout(function(){var b=!1;try{b=a("body").find(k.relatedTarget).length?
!0:b}catch(c){}d=d.not(k.target);0===d.size()&&!b&&(e=!1)},1);setTimeout(function(){!e&&!inDZ&&(c.trigger("WindowDragHoverEnd"),b=a(),d=a())},2)});c.dropzone.on("dragenter",function(a){0===b.size()&&(c.trigger("WindowDragHoverStart"),e=!1,inDZ=!0);b=b.add(a.target)});c.dropzone.on("dragleave drop",function(k){setTimeout(function(){var c=!1;try{c=a("body").find(k.relatedTarget).length?!0:c}catch(d){}b=b.not(k.target);0===b.size()&&!c&&(inDZ=!1)},1);setTimeout(function(){!e&&!inDZ&&(c.trigger("WindowDragHoverEnd"),
b=a(),d=a())},2)})}});a.zluxUpload=e})(jQuery);
(function(a){var e=function(){};e.prototype=a.extend(e.prototype,{name:"zluxFilesPreview",options:{},initialize:function(c,d){this.options=a.extend({},this.options,d)}});a.fn[e.prototype.name]=function(){if(!this.data(e.prototype.name)){var c=arguments,d=c[0]?c[0]:null;return this.each(function(){var b=a(this);if(e.prototype[d]&&b.data(e.prototype.name)&&"initialize"!=d)b.data(e.prototype.name)[d].apply(b.data(e.prototype.name),Array.prototype.slice.call(c,1));else if(!d||a.isPlainObject(d)){var f=
new e;e.prototype.initialize&&f.initialize.apply(f,a.merge([b],c));b.data(e.prototype.name,f)}else a.error("Method "+d+" does not exist on jQuery."+e.name)})}}})(jQuery);
(function(a){var e=function(){};e.prototype=a.extend(e.prototype,{name:"zluxSaveElement",options:{msgSaveElement:"Save Element",item_id:0,elm_id:"",ajax_url:""},initialize:function(c,d){this.options=a.extend({},this.options,d);var b=this;a('<a class="btn btn-small save" href="javascript:void(0);" />').append('<i class="icon-ok-sign"></i> '+b.options.msgSaveElement).on("click",function(){var c=a(this).addClass("btn-working"),d=c.closest(".element").find("input, textarea").serializeArray();a.post(b.options.ajax_url+
"&task=saveelement&item_id="+b.options.item_id+"&elm_id="+b.options.elm_id,d,function(){c.removeClass("btn-working")})}).appendTo(c.find(".btn-toolbar"))}});a.fn[e.prototype.name]=function(){var c=arguments,d=c[0]?c[0]:null;return this.each(function(){var b=a(this);if(e.prototype[d]&&b.data(e.prototype.name)&&"initialize"!=d)b.data(e.prototype.name)[d].apply(b.data(e.prototype.name),Array.prototype.slice.call(c,1));else if(!d||a.isPlainObject(d)){var f=new e;e.prototype.initialize&&f.initialize.apply(f,
a.merge([b],c));b.data(e.prototype.name,f)}else a.error("Method "+d+" does not exist on jQuery."+e.name)})}})(jQuery);
(function(a){var e=function(c){this.options=a.extend({},this.options,c);this.events={}};e.prototype=a.extend(e.prototype,a.zluxMain.prototype,{name:"zluxItemsFilter",options:{wrapper:null},init:function(){this.wrapper=a('<div class="zlux-itemsfilter" />').appendTo(this.options.wrapper).hide();this.filterlist=a('<ul class="unstyled zlux-itemsfilter-filterlist" />').appendTo(this.wrapper);this.filterlist.append('<form class="form-horizontal"><fieldset><div class="control-group"><label class="control-label">Multiple Checkboxes</label><div class="controls"><label class="checkbox"><input type="checkbox" name="checkboxes" value="Option one">Option one</label><label class="checkbox"><input type="checkbox" name="checkboxes" value="Option two">Option two</label></div></div></fieldset></form>');
this.inited=!0}});a.zluxItemsFilter=e})(jQuery);