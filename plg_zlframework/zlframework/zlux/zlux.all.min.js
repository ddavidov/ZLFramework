/* ===================================================
 * ZLUX Main
 * https://zoolanders.com/extensions/zl-framework
 * ===================================================
 * Copyright (C) JOOlanders SL 
 * http://www.gnu.org/licenses/gpl-2.0.html GNU/GPLv2 only
 * ========================================================== */
(function(a){var b=function(e){this.options=a.extend({},this.options,e);this.events={}};b.prototype=a.extend(b.prototype,{name:"zluxMain",options:{},events:{},createCache:function(e){var c={};return function(d,b){c[d]||(c[d]=a.Deferred(function(c){e(c,d)}).promise());return c[d].done(b)}},JRoot:function(){return a.fn[b.prototype.name].prototype.JRoot},AjaxURL:function(){return this.JRoot()+"index.php?option=com_zoo&controller=zlux&format=raw"},trigger:function(e){var c=this.events[e.toLowerCase()], d,a;if(c)for(a=Array.prototype.slice.call(arguments),a[0]=this,d=0;d<c.length;d++)if(!1===c[d].func.apply(c[d].scope,a))return!1;return!0},bind:function(e,c,d){var a;e=e.toLowerCase();a=this.events[e]||[];a.push({func:c,scope:d||this});this.events[e]=a;return this},unbind:function(e,c){e=e.toLowerCase();var a=this.events[e],b;if(a){if(c!==undef)for(b=a.length-1;0<=b;b--){if(a[b].func===c){a.splice(b,1);break}}else a=[];a.length||delete this.events[e]}},unbindAll:function(){var e=this;plupload.each(events, function(a,b){e.unbind(b)})},hasEventListener:function(a){return!!this.events[a.toLowerCase()]},_ErrorLog:function(a,c){var b=void 0===this.ID?this.name+": "+c:this.name+" warning (id = '"+this.ID+"'): "+c;0===a?alert(b):window.console&&console.log&&console.log(b)},translate:function(e){return a.fn[b.prototype.name].translations[e]||e},_:function(a){return this.translate(a)},sprintf:function(a){var b=[].slice.call(arguments,1),d="";a.split(/%[sdf]/).forEach(function(a){d+=a;b.length&&(d+=b.shift())}); return d}});a.fn[b.prototype.name]=b})(jQuery); (function(a){var b=function(b){this.options=a.extend({},this.options,b);this.events={}};b.prototype=a.extend(b.prototype,a.fn.zluxMain.prototype,{name:"zluxManager",options:{},events:{},initialize:function(b,c){this.options=a.extend({},this.options,c)},reload:function(){var a=this.oTable.fnSettings();a.bReloading=!0;this.oTable.fnReloadAjax(a.sAjaxSource)},pushMessageToObject:function(b,c){"string"==typeof c?c=a("<div>"+c+"</div>"):1<c.length&&a.each(c,function(b,e){c[b]=a("<div>"+e+"</div>")});var d= a(".zlux-x-msg",b.dom),f=a('<div class="zlux-x-details-content zlux-x-msg" />').hide().append(c,a('<i class="zlux-x-msg-remove icon-remove" />').on("click",function(){f.fadeOut()})).prependTo(a(".zlux-x-details",b.dom)).slideDown("fast",function(){d.fadeOut("slow",function(){a(this).remove()})});return f},pushStorageData:function(a){"s3"==this.options.storage&&(a.push({name:"storage",value:"s3"}),a.push({name:"accesskey",value:this.options.storage_params.accesskey}),a.push({name:"key",value:this.options.storage_params.secretkey}), a.push({name:"bucket",value:this.options.storage_params.bucket}));return a}});a.fn[b.prototype.name]=function(){if(!this.data(b.prototype.name)){var e=arguments,c=e[0]?e[0]:null;return this.each(function(){var d=a(this);if(b.prototype[c]&&d.data(b.prototype.name)&&"initialize"!=c)d.data(b.prototype.name)[c].apply(d.data(b.prototype.name),Array.prototype.slice.call(e,1));else if(!c||a.isPlainObject(c)){var f=new b;b.prototype.initialize&&f.initialize.apply(f,a.merge([d],e));d.data(b.prototype.name, f)}else a.error("Method "+c+" does not exist on jQuery."+b.name)})}};a.fn[b.prototype.name]=b})(jQuery); (function(a){var b=function(){};b.prototype=a.extend(b.prototype,{name:"zluxSaveElement",options:{msgSaveElement:"Save Element",item_id:0,elm_id:""},initialize:function(b,c){this.options=a.extend({},this.options,c);var d=this;a('<a class="btn btn-small save" href="javascript:void(0);" />').append('<i class="icon-ok-sign"></i> '+d.options.msgSaveElement).on("click",function(){var b=a(this).addClass("btn-working"),c=b.closest(".element").find("input, textarea").serializeArray();a.post(d.AjaxUrl+"&task=saveelement&item_id="+ d.options.item_id+"&elm_id="+d.options.elm_id,c,function(a){b.removeClass("btn-working")})}).appendTo(b.find(".btn-toolbar"))}});a.fn[b.prototype.name]=function(){var e=arguments,c=e[0]?e[0]:null;return this.each(function(){var d=a(this);if(b.prototype[c]&&d.data(b.prototype.name)&&"initialize"!=c)d.data(b.prototype.name)[c].apply(d.data(b.prototype.name),Array.prototype.slice.call(e,1));else if(!c||a.isPlainObject(c)){var f=new b;b.prototype.initialize&&f.initialize.apply(f,a.merge([d],e));d.data(b.prototype.name, f)}else a.error("Method "+c+" does not exist on jQuery."+b.name)})}})(jQuery); (function(a){var b=function(b){this.options=a.extend({},this.options,b);this.events={}};b.prototype=a.extend(b.prototype,a.fn.zluxMain.prototype,{name:"zluxExample",options:{param:""},events:{},initialize:function(b,c){this.options=a.extend({},a.fn.zluxMain.prototype.options,this.options,c)},some_function:function(){}});a.fn[b.prototype.name]=function(){var e=arguments,c=e[0]?e[0]:null;return this.each(function(){var d=a(this);if(b.prototype[c]&&d.data(b.prototype.name)&&"initialize"!=c)d.data(b.prototype.name)[c].apply(d.data(b.prototype.name), Array.prototype.slice.call(e,1));else if(!c||a.isPlainObject(c)){var f=new b;b.prototype.initialize&&f.initialize.apply(f,a.merge([d],e));d.data(b.prototype.name,f)}else a.error("Method "+c+" does not exist on jQuery."+b.name)})}})(jQuery);


/* ===================================================
 * ZLUX Dialog
 * https://zoolanders.com/extensions/zl-framework
 * Eg: new $.zluxDialog();
 * ===================================================
 * Copyright (C) JOOlanders SL 
 * http://www.gnu.org/licenses/gpl-2.0.html GNU/GPLv2 only
 * ========================================================== */
(function(b){var f=function(a){this.options=b.extend({},this.options,a);this.events={}};f.prototype=b.extend(f.prototype,b.fn.zluxMain.prototype,{name:"zluxDialog",options:{width:"300",height:"150",title:"Dialog"},events:{},initialize:function(a){this.options=b.extend({},this.options,a);this.creatingDialog=b.Deferred();return this.creatingDialog.promise(this)},initDialog:function(){var a=this;a.options.dialogClass="zlux-dialog "+a.options.dialogClass;a.main=b("<div />").appendTo(b("body")).dialog(b.extend({autoOpen:1, resizable:!1,height:"auto"},a.options));a.main.hide();a.content=b('<div class="zlux-dialog-content" />').appendTo(a.main);a.widget=a.main.dialog("widget");a.main.on("dialogopen",function(){a.widget.data("dialog-dragged")||a.widget.position(b.extend({my:"center",at:"center",of:window},a.options.position)).data("dialog-dragged",1)});a._spinner=b('<i class="zlux-loader-circle-big icon-spinner icon-spin" />').appendTo(a.widget);a._spinner_area=a.main;a.main.addClass("zlux-scroller").nanoScroller({preventPageScrolling:!0, contentClass:"zlux-dialog-content"});a.toolbar={};a.toolbar.wrapper=b('<div class="zlux-dialog-toolbar" />').hide().insertAfter(a.widget.children()[0]);b(".ui-dialog-titlebar-close",a.widget).html('<i class="icon-remove" />');a.creatingDialog.resolve()},initContent:function(){this.main.show();this.widget.attr("data-zlux-status","ready");this.scrollbar("refresh");this.inited=!0;this.spinner("hide")},toggle:function(){"pending"==this.creatingDialog.state()?this.initDialog():"resolved"==this.creatingDialog.state()&& this.dialog(this.dialog("isOpen")?"close":"open")},dialog:function(a){return this.main.dialog(a)},scrollbar:function(a){"refresh"==a?(a=b(".pane .slider",this.main),this.scrollbar("show"),this.main.nanoScroller(),a=Math.round(this.main.height())-Math.round(a.height()),0<=a&&5>=a&&this.scrollbar("hide")):"hide"==a?this.main.nanoScroller({stop:!0}):"show"==a?this.main.nanoScroller({stop:!1}):this.main.nanoScroller(a)},spinner:function(a){this.inited&&("show"==a?(this.main.fadeTo(0,0.5),this._spinner.show(), this.scrollbar("hide")):(this.scrollbar("show"),this._spinner.hide(),this.main.add(this.toolbar.wrapper).fadeTo("slow",1)))},newToolbar:function(a,c,d){var e=b('<div class="zlux-dialog-toolbar-'+c+'"><ul class="inline" /></div>').appendTo(this.toolbar.wrapper);b.each(a,function(a,c){b("ul",e).append(b("<li />").append(b('<i data-id="'+c.id+'" class="icon-'+c.icon+' icon-2x icon-border" title="'+c.title+'">'+(c.subicon?'<i class="icon-'+c.subicon+'"></i>':"")+"</i>").on("click",function(){if(b(this).hasClass("disabled"))return!1; c.click(b(this))})))});b(".zlux-dialog-toolbar-backtomain",this.toolbar.wrapper).on("click",function(){d()})},newSubToolbar:function(a,c){b('<div class="zlux-dialog-subtoolbar-'+a+'" />').hide().appendTo(b(".zlux-dialog-toolbar-"+c,this.toolbar.wrapper))},setMainToolbar:function(a){var c=this;c.newToolbar(a,"main");c.toolbar.wrapper.prepend(b('<i class="zlux-dialog-toolbar-backtomain icon-reply icon-border" title="Back to Main view" />').on("click",function(){b('[class^="zlux-dialog-toolbar-"]',c.toolbar.wrapper).hide(); b(".zlux-dialog-toolbar-main",c.toolbar.wrapper).show()}))},showToolbar:function(a){b(".zlux-dialog-toolbar-"+a,this.toolbar.wrapper).show();b(".zlux-dialog-toolbar-main",this.toolbar.wrapper).hide();b(".zlux-dialog-toolbar-backtomain",this.toolbar.wrapper).show()},toggleSubtoolbar:function(a,c){c=b(".zlux-dialog-toolbar-"+c,this.toolbar.wrapper);var d=b(".zlux-dialog-subtoolbar-"+a,c);d.siblings("div").slideUp("fast",function(){d.slideToggle("fast")})},toolbarBtnState:function(a,c,d){var e=b(".zlux-dialog-toolbar-"+ a+' i[data-id="'+c+'"]',this.toolbar.wrapper);"disabled"==d?e.animate({color:"#C0C0C0"},200,function(){e.addClass("disabled")}):e.animate({color:"#444"},200,function(){e.removeClass("disabled")})}});b.fn[f.prototype.name]=function(){var a=arguments,b=new f;if(f.prototype.initialize)return b.initialize.apply(b,a)}})(jQuery);


/* ===================================================
 * ZLUX Files Manager
 * https://zoolanders.com/extensions/zl-framework
 * ===================================================
 * Copyright (C) JOOlanders SL 
 * http://www.gnu.org/licenses/gpl-2.0.html GNU/GPLv2 only
 * ========================================================== */
(function(c){var f=function(a){this.options=c.extend({},this.options,a);this.events={}};f.prototype=c.extend(f.prototype,c.fn.zluxManager.prototype,{name:"zluxFilesManager",options:{root:"images",extensions:"",storage:"local",storage_params:{},max_file_size:""},events:{},initialize:function(a,b){this.options=c.extend({},this.options,b);this.initCheck();this.target=a;this.filesmanager=c('<div class="zl-bootstrap zlux-filesmanager" />').appendTo(a);this.initDataTable(this.filesmanager)},initCheck:function(){c.fn.zluxFilesManager.iNextUnique++;
this.ID=c.fn.zluxFilesManager.iNextUnique;this.options.max_file_size=plupload.parseSize(this.options.max_file_size);if(""==this.options.storage||void 0==this.options.storage||null==this.options.storage)this._ErrorLog(0,this._("STORAGE_PARAM_MISSING")),this.options.storage="local"},initDataTable:function(a){var b=this,d=b.AjaxURL()+"&task=getFilesManagerData";c('<table cellpadding="0" cellspacing="0" border="0" class="table table-striped table-bordered" />').appendTo(a);b.oTable=c("table",a).dataTable({sDom:"F<'row-fluid'<'span12'B>><'row-fluid'<'span12't>>",
oLanguage:{sEmptyTable:b._("EMPTY_FOLDER"),sInfoEmpty:""},sAjaxUrl:b.AjaxURL(),sAjaxSource:d,sServerMethod:"POST",sStartRoot:b.cleanPath(b.options.root),bPaginate:!1,aoColumns:[{sTitle:"",mData:"type",bSearchable:!1,sWidth:"14px",sClass:"column-icon",mRender:function(a,b,c){return"display"==b?'<i class="icon-'+("folder"==a?"folder-close":"file-alt")+'"></i>':a}},{sTitle:b._("NAME"),mData:"name",sClass:"column-name",mRender:function(a,b,c){return"display"==b?"":a},fnCreatedCell:function(a,d,g,k,f){c(a).parent("tr").attr("data-id",
b.cleanPath(g.name))}}],aoColumnDefs:{bVisible:!1,aTargets:[2]},aaSorting:[[0,"desc"],[1,"asc"]],fnServerData:function(a,c,d,k){b._fnServerData(a,c,d,k)},fnServerParams:function(a){a.push({name:"extensions",value:b.options.extensions});"s3"==b.options.storage&&(a.push({name:"storage",value:"s3"}),a.push({name:"accesskey",value:b.options.storage_params.accesskey}),a.push({name:"key",value:b.options.storage_params.secretkey}),a.push({name:"bucket",value:b.options.storage_params.bucket}))},fnRowCallback:function(a,
d,g,k){d.dom=c(a);d.dom.attr("data-type",d.type).addClass("zlux-object");c(".column-name",d.dom).html("").removeClass("zlux-ui-open").append(b.renderObjectDOM(d));c(".zlux-x-name",d.dom).append('<i class="zlux-x-name-edit icon-edit-sign" title="'+b._("RENAME")+'" />')},fnInitComplete:function(d,h){var g=c(".zlux-x-filter-input_wrapper",a).append(c('<i class="icon-search" />'),c('<i class="icon-remove zlux-ui-dropdown-unselect" />').hide().on("click",function(){c("input",g).val("");c(this).hide();
b.oTable.fnFilter("")}));c("input",g).on("keyup",function(){""==c(this).val()?c(".zlux-ui-dropdown-unselect",g).hide():c(".zlux-ui-dropdown-unselect",g).show()});b.trigger("InitComplete")},fnPreDrawCallback:function(a){b.zluxdialog.spinner("show")},fnDrawCallback:function(a){var d=a.oInstance.fnPagingInfo();a=c(".dataTables_paginate",c(a.nTableWrapper)).closest(".row-fluid");1>=d.iTotalPages&&a.hide()||a.show();b.zluxdialog.scrollbar("refresh");b.zluxdialog.spinner("hide")}}).on("click",".zlux-object .zlux-x-name a",
function(){var a=c(this).closest("tr.zlux-object"),d=b.oTable.fnGetData(a[0]),g=b.oTable.fnSettings();d.dom=a;"true"!=d.dom.attr("data-zlux-object-status")&&(d.dom.attr("data-zlux-object-status","true"),d.dom.siblings().removeAttr("data-zlux-object-status"),"folder"==d.dom.data("type")&&(b.oTable.fnSettings(),g.sGoToPath=d.dom.data("id"),b.oTable.fnReloadAjax(g.sAjaxSource)),b.trigger("ObjectSelected",d));return!1}).on("click",".zlux-object .zlux-x-remove",function(){var a=c(this).closest("tr.zlux-object"),
d=c("td",a),g=b.oTable.fnGetData(a[0]);g.dom=a;d.hasClass("zlux-ui-open")?b.trigger("BeforeDeleteFile",g):row.removeAttr("data-checked");return!1})},_fnServerData:function(a,b,d,e){var h=this,g;e.aAjaxDataCache=e.aAjaxDataCache?e.aAjaxDataCache:{};c.isEmptyObject(e.aAjaxDataCache)&&(e.sCurrentPath=e.oInit.sStartRoot);g=h.cleanPath(e.sCurrentPath+"/"+e.sGoToPath);e.sGoToPath="";b.push({name:"root",value:g});e.jqXHR=c.ajax({url:a,data:b,beforeSend:function(a,b){var f=!1;if(!e.bReloading){var l=e.aAjaxDataCache[g];
l&&(e.sCurrentPath=g,c(e.oInstance).trigger("xhr",[e,l]),d(l),f=!0)}if(f)return!1;h.zluxdialog.spinner("show")},success:function(a){a.sError&&e.oApi._fnLog(e,0,a.sError);c.isEmptyObject(e.aAjaxDataCache)&&(e.oInit.sStartRoot=a.root);e.sCurrentPath=a.root;e.bReloading&&(e.aAjaxDataCache={});e.aAjaxDataCache[a.root]=a;e.bReloading=!1;c(e.oInstance).trigger("xhr",[e,a]);d(a)},dataType:"json",cache:!1,type:e.sServerMethod,error:function(a,b,c){"parsererror"==b&&e.oApi._fnLog(e,0,"DataTables warning: JSON data from server could not be parsed. This is caused by a JSON formatting error.")}})},
_getFullPath:function(a){var b=this.oTable.fnSettings().sCurrentPath;return b?b+"/"+a:a},cleanPath:function(a){return a.replace(/undefined/g,"").replace(/\/\//g,"/").replace(/(^\/|\/$)/g,"")},_getRowFromPath:function(a){return c('tr[data-path="'+a+'"]',this.oTable)},renderObjectDOM:function(a){var b;b="folder"==a.type?[{name:this._("NAME"),value:a.basename}]:[{name:this._("NAME"),value:a.basename},{name:this._("TYPE"),value:a.content_type},{name:this._("SIZE"),value:a.size.display}];var d="";c.each(b,
function(a,b){d+="<li><strong>"+b.name+"</strong>: <span>"+b.value+"</span></li>"});return c('<div class="zlux-x-tools"><i class="zlux-x-details-btn icon-angle-down" /><i class="zlux-x-remove icon-minus-sign" title="'+this._("DELETE")+'" /></div><div class="zlux-x-name"><a href="#" class="zlux-x-name-link">'+a.name+'</a></div><div class="zlux-x-details"><div class="zlux-x-messages" /><div class="zlux-x-details-content"><ul class="unstyled">'+d+"</ul></div></div>")},deleteObject:function(a){var b=
this,d=[],e=b._getFullPath(a.name),d=b.pushStorageData(d);"s3"==b.options.storage&&"folder"==a.type&&(e+="/");d.push({name:"path",value:e});return c.Deferred(function(a){c.ajax({url:b.AjaxURL()+"&task=deleteObject",data:d,dataType:"json",type:"post"}).done(function(c){c.result?(a.resolve(),b.trigger("FileDeleted",e)):a.reject(c.errors)}).fail(function(){a.reject(b._("SOMETHING_WENT_WRONG"))})}).promise()},createFolder:function(a){var b=this,d=[];a=b._getFullPath(a);d=b.pushStorageData(d);"s3"==b.options.storage&&
(a+="/");d.push({name:"path",value:a});return c.Deferred(function(a){c.ajax({url:b.AjaxURL()+"&task=newFolder",data:d,dataType:"json",type:"post"}).done(function(b){b.result?a.resolve(b.name):a.reject(b.errors)}).fail(function(){a.reject(b._("SOMETHING_WENT_WRONG"))})}).promise()},renameObject:function(a){var b=this,d=c(".zlux-x-name a",a.dom),e=d.html().match(/\.+[a-zA-Z]+$/g),h=d.html().replace(/\.+[a-zA-Z]+$/g,""),e=null!==e?e:"",g=c("<div>"+b._("INPUT_THE_NEW_NAME")+'<br /><input class="zlux-x-input" type="text" value="'+
h+'" /> '+e+'<br /><span class="label label-success label-link">'+b._("CONFIRM").toLowerCase()+"</span></div>").on("click",".label-link",function(){c(this).data("submited")||(c(this).data("submited",!0),c(".column-icon i",a.dom).addClass("icon-spinner icon-spin"),b._changeObjectName(a,c("input",g).val()+e).done(function(b){d.html(b);c(".zlux-x-details-content ul li:first span",a.dom).html(b);a.dom.attr("data-id",b);a.name=b;a.basename=b.replace(/\.+[a-zA-Z]+$/g,"");a.path=a.path.replace(/(\w|[-.])+$/,
b);c(".zlux-x-msg",a.dom).remove()}).fail(function(c){b.pushMessageToObject(a,c)}).always(function(b){c(".column-icon i",a.dom).removeClass("icon-spinner icon-spin")}))}).on("keypress","input",function(a){13==(a.keyCode?a.keyCode:a.which)&&c(".label-link",g).trigger("click")});b.pushMessageToObject(a,g)},_changeObjectName:function(a,b){var d=this,e=[],h=d._getFullPath(a.name);dest=d._getFullPath(b);e=d.pushStorageData(e);"s3"==d.options.storage&&"folder"==a.type&&(h+="/",dest+="/");e.push({name:"src",
value:h});e.push({name:"dest",value:dest});return c.Deferred(function(a){c.ajax({url:d.AjaxURL()+"&task=moveObject",data:e,dataType:"json",type:"post"}).done(function(b){b.result?a.resolve(b.name):a.reject(b.errors)}).fail(function(){a.reject(d._("SOMETHING_WENT_WRONG"))})}).promise()}});c.fn[f.prototype.name]=function(){var a=arguments,b=a[0]?a[0]:null;return this.each(function(){var d=c(this);if(f.prototype[b]&&d.data(f.prototype.name)&&"initialize"!=b)d.data(f.prototype.name)[b].apply(d.data(f.prototype.name),
Array.prototype.slice.call(a,1));else if(!b||c.isPlainObject(b)){var e=new f;f.prototype.initialize&&e.initialize.apply(e,c.merge([d],a));d.data(f.prototype.name,e)}else c.error("Method "+b+" does not exist on jQuery."+f.name)})};c.fn[f.prototype.name]=f;c.fn[f.prototype.name].iNextUnique=0})(jQuery);
(function(c){var f=function(a){this.options=c.extend({},this.options,a);this.events={}};f.prototype=c.extend(f.prototype,c.fn.zluxFilesManager.prototype,{name:"zluxDialogFilesManager",options:{title:"Files Manager",full_mode:0},events:{},initialize:function(a,b){this.options=c.extend({},c.fn.zluxFilesManager.prototype.options,this.options,b);var d=this;d.initCheck();d.dialogTrigger=c('<a title="'+d.options.title+'" class="btn btn-mini zlux-btn-edit" href="#"><i class="icon-edit"></i></a>').insertAfter(a).on("click",
function(){d.zluxdialog.toggle();return!1});d.initDialog();d.initMainEvents()},initDialog:function(){var a=this;a.zluxdialog=c.fn.zluxDialog({title:a.options.title,width:a.options.full_mode?"75%":300,dialogClass:"zl-bootstrap zlux-filesmanager "+(a.options.full_mode?"zlux-dialog-full":""),position:!1==a.options.full_mode?{of:a.dialogTrigger,my:"left top",at:"right bottom"}:null}).done(function(){a.zluxdialog.widget.attr("id","zluxFilesManager_"+a.ID);a.eventDialogLoaded()})},eventDialogLoaded:function(){var a=
this;a.filesmanager=c('<div class="zlux-filesmanager" />').appendTo(a.zluxdialog.content);a.initDataTable(a.filesmanager);a.zluxdialog.main.on("click",".zlux-x-details-btn",function(){var b=c(this),d=b.closest("tr.zlux-object"),e=c("td.column-name",d),h=c(".zlux-x-details",d);e.hasClass("zlux-ui-open")?(b.addClass("icon-angle-down").removeClass("icon-angle-up"),e.removeClass("zlux-ui-open"),h.slideUp("fast",function(){a.zluxdialog.scrollbar("refresh")})):(e.addClass("zlux-ui-open"),b.removeClass("icon-angle-down").addClass("icon-angle-up"),
a.zluxdialog.content.stop().animate({scrollTop:d.get(0).offsetTop},900,"swing"),h.slideDown("fast",function(){a.zluxdialog.scrollbar("refresh")}))});a.zluxdialog.main.on("click",".icon-edit-sign",function(){var b=c(this).closest("tr.zlux-object");$object=a.oTable.fnGetData(b[0]);$object.dom=b;a.renameObject($object)});c("html").on("mousedown",function(b){!a.zluxdialog.dialog("isOpen")||a.dialogTrigger.is(b.target)||a.dialogTrigger.find(b.target).length||a.zluxdialog.widget.find(b.target).length||
a.zluxdialog.dialog("close")});a.initMainToolbar();a.zluxdialog.newSubToolbar("filter","main");a.zluxdialog.newSubToolbar("newfolder","main");a.initUploader();a.zluxdialog.newToolbar([{title:a._("ADD_NEW_FILES"),icon:"plus-sign",id:"add",click:function(){c(".zlux-upload-browse",a.zluxupload.upload).siblings(".moxie-shim").children("input").trigger("click")}},{title:a._("START_UPLOADING"),icon:"upload disabled",id:"start",click:function(){a.zluxupload.uploader.start();return!1}},{title:a._("CANCEL_CURRENT_UPLOAD"),
icon:"ban-circle disabled",id:"cancel",click:function(){a.zluxupload.uploader.stop();a.zluxdialog.toolbarBtnState(2,"ban-circle","disabled");a.zluxdialog.toolbarBtnState(2,"upload","enabled");a.zluxdialog.toolbarBtnState(2,"plus-sign","enabled")}}],2,function(){c(".zlux-upload",a.zluxdialog.content).fadeOut("400",function(){a.zluxupload.emptyQueue();c(".zlux-filesmanager",a.zluxdialog.content).fadeIn("400");a.zluxupload._updateFilelist();a.zluxdialog.scrollbar("refresh")})})},initMainEvents:function(){var a=
this;a.bind("InitComplete",function(b){a.zluxdialog.scrollbar("refresh");b=c(".zlux-dialog-subtoolbar-filter",a.zluxdialog.toolbar.wrapper);c(".zlux-x-filter-input_wrapper",a.oTable.fnSettings().nTableWrapper).appendTo(b);a.zluxdialog.initContent()}).bind("BeforeDeleteFile",function(b,d){if(!c(".zlux-x-details-message-actions")[0]){var e=c("<div>"+a._("folder"==d.type?"DELETE_THIS_FOLDER":"DELETE_THIS_FILE")+'<span class="label label-warning label-link">'+a._("CONFIRM").toLowerCase()+"</span></div>").on("click",
".label-link",function(){c(this).data("submited")||(c(this).data("submited",!0),c(".column-icon i",d.dom).addClass("icon-spinner icon-spin"),a.deleteObject(d).done(function(){d.dom.fadeOut("slow",function(){c(this).remove();var b=a.oTable.fnSettings().aAjaxDataCache[a.oTable.fnSettings().sCurrentPath].aaData;c.each(b,function(a,c){if(d.dom.data("id")==c.name&&d.dom.data("type")==c.type)return b.splice(a,1),!1})})}).fail(function(b){a.pushMessageToObject(d,b)}).always(function(a){c(".column-icon i",
d.dom).removeClass("icon-spinner icon-spin")}))});a.pushMessageToObject(d,e)}})},initMainToolbar:function(){var a=this;a.zluxdialog.setMainToolbar([{title:a._("APPLY_FILTERS"),icon:"filter",click:function(b){a.zluxdialog.toggleSubtoolbar("filter","main");b.parent().siblings().children("i").not(b).removeClass("zlux-ui-tool-enabled");b.toggleClass("zlux-ui-tool-enabled")}},{title:a._("NEW_FOLDER"),icon:"folder-close",subicon:"plus-sign",click:function(b){a.zluxdialog.toggleSubtoolbar("newfolder","main");
c(".zlux-dialog-subtoolbar-newfolder",a.zluxdialog.toolbar.wrapper).html("").append(c('<input type="text" class="zlux-x-input" placeholder="'+a._("FOLDER_NAME")+'" />').on("keypress",function(b){13==(b.keyCode?b.keyCode:b.which)&&(a.createFolder(c(this).val()),a.zluxdialog.spinner("show"),a.createFolder(c(this).val()).always(function(b){a.reload()}))}));b.parent().siblings().children("i").not(b).removeClass("zlux-ui-tool-enabled");b.toggleClass("zlux-ui-tool-enabled")}},{title:a._("UPLOAD_FILES"),
icon:"cloud-upload",click:function(){a.zluxdialog.showToolbar(2);a.zluxdialog.scrollbar("hide");c(".zlux-filesmanager",a.zluxdialog.content).fadeOut("400",function(){a.zluxupload.inited||a.zluxupload.init();a.zluxupload.options.path=a.oTable.fnSettings().sCurrentPath;c(".zlux-upload",a.zluxdialog.content).fadeIn("400")})}},{title:a._("REFRESH"),icon:"refresh",click:function(){a.reload()}}])},initUploader:function(){var a=this;a.zluxupload=new c.fn.zluxUpload({path:"images",wrapper:a.zluxdialog.content,
storage:a.options.storage,storage_params:a.options.storage_params,max_file_size:a.options.max_file_size,extensions:a.options.extensions});a.zluxupload.bind("QueueChanged",function(b){a.zluxdialog.scrollbar("refresh")}).bind("FilesAdded",function(b,d){a.zluxdialog.toolbarBtnState(2,"upload","enabled");b.filelist.show();c.each(d,function(d,h){h.status="validating";var g={name:h.name,basename:h.name.replace(/(\.[a-z0-9]+)$/,""),type:"file",content_type:h.type,size:{size:h.size,display:plupload.formatSize(h.size)}};
g.dom=c('<tr id="'+h.id+'" class="zlux-object" data-zlux-status="validating" />').append(c('<td class="column-icon" />').append('<i class="icon-file-alt zlux-x-object-icon" />'),c('<td class="column-name" />').append(a.renderObjectDOM(g))).appendTo(b.filelist);c(".zlux-x-tools",g.dom).append(c('<span class="zlux-upload-file-progress"/>'));c(".zlux-x-name",g.dom).html(h.name);if(void 0!==h.size&&h.size>a.options.max_file_size){c(".icon-file-alt",g.dom).removeClass("icon-file-alt").addClass("icon-warning-sign");
var f=a.pushMessageToObject(g,a.sprintf(a._("FILE_SIZE_ERROR"),plupload.formatSize(a.options.max_file_size)));c(".zlux-x-msg-remove",f).remove();return!0}c.ajax({url:a.AjaxURL()+"&task=validateObjectName",type:"post",data:{name:h.name},dataType:"json",cache:!1,beforeSend:function(a,b){c(".column-icon i",g.dom).addClass("icon-spinner icon-spin")},success:function(a){c(".zlux-x-name",g.dom).html(a.result);h.name=a.result;h.status=1;b._handleFileStatus(h);c(".column-icon i",g.dom).removeClass("icon-spinner icon-spin");
b._updateFilelist()}})})}).bind("BeforeUpload",function(b){a.zluxdialog.toolbarBtnState(2,"cancel","enabled");a.zluxdialog.toolbarBtnState(2,"start","disabled");a.zluxdialog.toolbarBtnState(2,"add","disabled")}).bind("FileUploaded",function(b,d){c(".zlux-x-name",d.dom).html(d.name);c(".zlux-upload-file-progress",d.dom).html("100%").fadeOut();c(".zlux-x-object-icon",d.dom).removeClass("icon-file-alt").addClass("icon-ok");c(".zlux-x-name",d.dom).wrapInner('<a class="zlux-x-name-link" href="#" />').end().on("click",
"a",function(){var b=c('.zlux-object[data-id="'+d.name+'"]',a.filesmanager);d=a.oTable.fnGetData(b[0]);a.trigger("ObjectSelected",d);return!1})}).bind("FileNotUpload",function(b,d,e){a.zluxdialog.toolbarBtnState(2,"cancel","disabled");a.zluxdialog.toolbarBtnState(2,"start","disabled");a.zluxdialog.toolbarBtnState(2,"add","enabled");c(".zlux-upload-file-progress",d.dom).fadeOut();c(".zlux-x-object-icon",d.dom).removeClass("icon-file-alt").addClass("icon-warning-sign");b=a.pushMessageToObject(d,e);
c(".zlux-x-msg-remove",b).remove()}).bind("UploadComplete",function(b){a.zluxdialog.toolbarBtnState(2,"cancel","disabled");a.zluxdialog.toolbarBtnState(2,"start","disabled");a.zluxdialog.toolbarBtnState(2,"add","enabled");a.reload()}).bind("CancelUpload",function(b){a.zluxdialog.toolbarBtnState(2,"cancel","disabled");a.zluxdialog.toolbarBtnState(2,"add","enabled")}).bind("QueueChanged",function(b,d){var e=!1;c.each(d,function(a,b){b.status!=plupload.DONE&&"validating"!=b.status&&(e=!0)});d.length?
e?a.zluxdialog.toolbarBtnState(2,"start","enabled"):a.zluxdialog.toolbarBtnState(2,"start","disabled"):a.zluxdialog.toolbarBtnState(2,"start","disabled")}).bind("FileError",function(b,d,e){a.uploading&&"pending"==a.uploading.state()?a.uploading.reject(e):(d.dom[0]||(d.dom=c('<tr id="'+d.id+'" class="zlux-object" />').append(c('<td class="column-icon" />').append('<i class="icon-file-alt zlux-x-object-icon" />'),c('<td class="column-name" />').append(a.renderObjectDOM(d))).appendTo(b.filelist),b._updateFilelist()),
c(".zlux-x-object-icon",d.dom).removeClass("icon-file-alt").addClass("icon-warning-sign"),b=a.pushMessageToObject(d,e),c(".zlux-x-msg-remove",b).remove())})}});c.fn[f.prototype.name]=function(){var a=arguments,b=a[0]?a[0]:null;return this.each(function(){var d=c(this);if(f.prototype[b]&&d.data(f.prototype.name)&&"initialize"!=b)d.data(f.prototype.name)[b].apply(d.data(f.prototype.name),Array.prototype.slice.call(a,1));else if(!b||c.isPlainObject(b)){var e=new f;f.prototype.initialize&&e.initialize.apply(e,
c.merge([d],a));d.data(f.prototype.name,e)}else c.error("Method "+b+" does not exist on jQuery."+f.name)})}})(jQuery);
(function(c){var f=function(a){this.options=c.extend({},this.options,a);this.events={}};f.prototype=c.extend(f.prototype,c.fn.zluxMain.prototype,{name:"zluxUpload",options:{extensions:"",path:null,fileMode:"files",max_file_size:"1024kb",wrapper:null,storage:"local",storage_params:{}},init:function(){var a=this;a.upload=c('<div class="zlux-upload" />').attr("data-zlux-status","").appendTo(a.options.wrapper).hide();a.dropzone=c('<div class="zlux-upload-dropzone" />').appendTo(a.upload).append(c('<span class="zlux-upload-dropzone-msg">'+
a.sprintf(a._("DROP_FILES"),"zlux-upload-browse")+"</span>"));a.initDnDevents();a.bind("WindowDragHoverStart",function(b,c){a.dropzone.attr("data-zlux-draghover",!0)});a.bind("WindowDragHoverEnd",function(b,c){a.dropzone.attr("data-zlux-draghover",!1)});a.initFilelist();a.initPlupload();a.inited=!0},initFilelist:function(){var a=this;a.filelist=c('<table cellpadding="0" cellspacing="0" border="0" class="zlux-upload-filelist table table-striped table-bordered"><tbody /></table>').appendTo(a.upload).on("click",
".zlux-x-remove",function(){if("uploding"!=c(this).closest(".zlux-object").data("zlux-status")){var b=c(this).closest(".zlux-object"),d=a.uploader.getFile(b[0].id);d&&("undefined"==d||d.zlux_status!=plupload.STARTED&&d.status!=plupload.UPLOADING)?(a.uploader.removeFile(d),b.remove()):(b.remove(),a._updateFilelist())}})},initPlupload:function(){var a=this,b;b={runtimes:"html5, flash",browse_button:c(".zlux-upload-browse",a.upload)[0],drop_element:a.dropzone[0],max_file_size:void 0,url:a.AjaxURL()+
"&task=upload",filters:[{title:"Files",extensions:this.options.extensions}],flash_swf_url:a.JRoot()+"plugins/system/zlframework/zlframework/zlux/assets/plupload/Moxie.swf"};"s3"==a.options.storage&&(b=c.extend(b,{url:"http://"+a.options.storage_params.bucket+".s3.amazonaws.com",multipart:!0,multipart_params:{key:"${filename}",Filename:"${filename}",acl:"public-read",success_action_status:"201",AWSAccessKeyId:a.options.storage_params.accesskey,policy:a.options.storage_params.policy,signature:a.options.storage_params.signature},
file_data_name:"file"}));b=c.extend(b,{init:{BeforeUpload:function(b,c){a.eventBeforeUpload(c)},UploadFile:function(b,c){a.eventUploadFile(c)},UploadProgress:function(b,c){a.eventUploadProgress(c)},FileUploaded:function(b,c,h){a.eventFileUploaded(c,h)},UploadComplete:function(b,c){a.eventUploadComplete(c)},CancelUpload:function(b){a.eventCancelUpload()},FilesAdded:function(b,c){a.eventFilesAdded(c)},QueueChanged:function(b){a.eventQueueChanged()},StateChanged:function(){a.eventStateChanged()},Error:function(b,
c){a.eventError(c)}}});a.uploader=new plupload.Uploader(b);a.uploader.bind("Init",function(){a.trigger("Init")});a.uploader.init()},eventError:function(a){var b=a.file,d,e;if(b){d="<strong>"+a.message+"</strong>";if(e=a.details)d+=" <br /><i>"+a.details+"</i>";else{switch(a.code){case plupload.FILE_EXTENSION_ERROR:e=this._("FILE_EXT_ERROR").replace("%s",b.name);break;case plupload.IMAGE_MEMORY_ERROR:e=this._("RUNTIME_MEMORY_ERROR");break;case plupload.HTTP_ERROR:e="s3"==this.options.storage?this.options.storage_params.bucket.match(/\./g)?
this._("S3_BUCKET_PERIOD_ERROR"):this._("S3_BUCKET_MISSCONFIG_ERROR"):this._("UPLOAD_URL_ERROR")}d+=" <br /><i>"+e+"</i>"}a={name:b.name,basename:b.name.replace(/(\.[a-z0-9]+)$/,""),type:"file",content_type:b.type,size:{size:b.size,display:plupload.formatSize(b.size)}};a.dom=c("#"+b.id,this.filelist);this.trigger("FileError",a,d)}},eventStateChanged:function(){this.uploader.state===plupload.UPLOADING&&this.upload.attr("data-zlux-status","uploading");this.uploader.state===plupload.STOPPED&&(this.upload.attr("data-zlux-status",
"stopped"),this._updateFilelist())},eventBeforeUpload:function(a){var b=c("#"+a.id,this.filelist);"local"==this.options.storage&&(this.uploader.settings.url=this.uploader.settings.url+"&path="+this.options.path);"s3"==this.options.storage&&(this.uploader.settings.multipart_params.key=(this.options.path?this.options.path+"/":"")+a.name);c(".zlux-upload-file-progress",b).html("0%");a.zlux_status=2;this._handleFileStatus(a);c(".zlux-upload-file-btn-remove",b).removeClass("icon-remove").addClass("icon-spinner icon-spin");
this.trigger("BeforeUpload",a)},eventUploadFile:function(a){var b=this,d={name:a.name,basename:a.name.replace(/(\.[a-z0-9]+)$/,""),type:"file",content_type:a.type,size:{size:a.size,display:plupload.formatSize(a.size)}};d.dom=c("#"+a.id,b.filelist);b.uploading=c.Deferred().fail(function(a){b.trigger("FileNotUpload",d,a)}).done(function(a){d.name=a;b.trigger("FileUploaded",d)}).always(function(c){b._handleFileStatus(a)})},eventUploadProgress:function(a){var b=isNaN(a.percent)?0:a.percent;c("#"+a.id+
" .zlux-upload-file-progress",this.filelist).html(b+"%");this._handleFileStatus(a)},eventFileUploaded:function(a,b){c("#"+a.id,this.filelist);if("local"==this.options.storage){var d=c.parseJSON(b.response);d.error?this.uploading.reject(d.error.message):this.uploading.resolve(d.result)}else"s3"==this.options.storage&&(d=c(b.response),this.uploading.resolve(d.find("Key").html()))},eventUploadComplete:function(a){this.trigger("UploadComplete",a)},eventCancelUpload:function(a){this.trigger("CancelUpload")},
eventFilesAdded:function(a){this.trigger("FilesAdded",a)},eventQueueChanged:function(){this._updateFilelist()},getQueuedFiles:function(){var a=[];c.each(this.uploader.files,function(b,c){c.status!=plupload.DONE&&"validating"!=c.status&&a.push(c)});return a},emptyQueue:function(){this.uploader.splice();this.filelist.empty()},_updateFilelist:function(){var a=this,b=!1,d=c(".zlux-object",a.filelist);c.each(a.uploader.files,function(c,d){d.status!=plupload.DONE&&"validating"!=d.status&&(b=!0);d.status==
plupload.STOPPED&&a._handleFileStatus(d)});(a.uploader.files.length||d.length)&&c(".zlux-upload-dropzone-msg",a.upload).hide();a.uploader.files.length||d.length?b?a.upload.attr("data-zlux-status","queued"):a.upload.attr("data-zlux-status","stopped"):(a.upload.attr("data-zlux-status",""),c(".zlux-upload-dropzone-msg",a.upload).fadeIn());a.trigger("QueueChanged",a.uploader.files)},_handleFileStatus:function(a){var b=c("#"+a.id,this.filelist),d="";a.zlux_status==plupload.STARTED?(d="started",a.zlux_status=
""):(a.status==plupload.DONE&&(d="done"),a.status==plupload.FAILED&&(d="failed"),a.status==plupload.QUEUED&&(d="queued"),a.status==plupload.UPLOADING&&(d="uploading"),a.status==plupload.STOPPED&&c(".zlux-upload-file-progress",b).html(""));b.attr("data-zlux-status",d)},initDnDevents:function(a){var b=this,d=c(),e=c(),f=!1;inDZ=!1;c(window).on("drop",function(a){a.preventDefault();return!1}).on("dragenter",function(a){0===d.size()&&(b.trigger("WindowDragHoverStart"),f=!0,inDZ=!1);d=d.add(a.target)}).on("dragleave drop",
function(a){setTimeout(function(){var b=!1;try{b=c("body").find(a.relatedTarget).length?!0:b}catch(e){}d=d.not(a.target);0!==d.size()||b||(f=!1)},1);setTimeout(function(){f||inDZ||(b.trigger("WindowDragHoverEnd"),e=c(),d=c())},2)});b.dropzone.on("dragenter",function(a){0===e.size()&&(b.trigger("WindowDragHoverStart"),f=!1,inDZ=!0);e=e.add(a.target)});b.dropzone.on("dragleave drop",function(a){setTimeout(function(){var b=!1;try{b=c("body").find(a.relatedTarget).length?!0:b}catch(d){}e=e.not(a.target);
0!==e.size()||b||(inDZ=!1)},1);setTimeout(function(){f||inDZ||(b.trigger("WindowDragHoverEnd"),e=c(),d=c())},2)})}});c.fn[f.prototype.name]=f})(jQuery);
(function(c){var f=function(a){this.options=c.extend({},this.options,a);this.events={}};f.prototype=c.extend(f.prototype,c.fn.zluxMain.prototype,{name:"zluxPreview",options:{},events:{},initialize:function(a,b){this.options=c.extend({},this.options,b);this.creatingDialog=c.Deferred();return this.creatingDialog.promise(this)},renderPreviewDOM:function(a,b){var d,e=[];b=void 0==b?!1:b;a.size=void 0==a.size?!1:a.size;e.push({name:"name",value:a.basename});"folder"==a.type?d='<span class="zlux-x-folder"></span>':
(d=b?'<div class="zlux-x-image"><img src="'+this.JRoot()+a.path+'" /></div>':'<span class="zlux-x-filetype">'+a.ext+"</span>",a.size&&e.push({name:"size",value:a.size.display}));var f="";c.each(e,function(a,b){f+="<li>"+b.value+"</li>"});return c('<div class="zlux-preview"><div class="zlux-x-thumbnail">'+d+'</div><ul class="zlux-x-details unstyled">'+f+"</ul></div>")}});c.fn[f.prototype.name]=function(){var a=arguments,b=new f;if(f.prototype.initialize)return b.initialize.apply(b,a)}})(jQuery);


/* ===================================================
 * ZLUX Items Manager
 * https://zoolanders.com/extensions/zl-framework
 * ===================================================
 * Copyright (C) JOOlanders SL 
 * http://www.gnu.org/licenses/gpl-2.0.html GNU/GPLv2 only
 * ========================================================== */
(function(c){var d=function(a){this.options=c.extend({},this.options,a);this.events={}};d.prototype=c.extend(d.prototype,c.fn.zluxManager.prototype,{name:"zluxItemsManager",options:{apps:"",types:"",categories:"",tags:""},initialize:function(a,b){this.options=c.extend({},this.options,b);this.filter={};this.initCheck();this.target=a;this.filesmanager=c('<div class="zl-bootstrap zlux-itemsmanager" />').appendTo(a);this.initDataTable(this.filesmanager)},initCheck:function(){c.fn.zluxItemsManager.iNextUnique++;
this.ID=c.fn.zluxItemsManager.iNextUnique},initDataTable:function(a){var b=this;c('<table cellpadding="0" cellspacing="0" border="0" class="table table-striped table-bordered" />').appendTo(a);b.oTable=c("table",a).dataTable({sDom:"F<'row-fluid'<'span12't>><'row-fluid'<'span12'p>><'row-fluid zlux-x-info'<'span12'i>>",bServerSide:!0,iDisplayLength:20,sAjaxSource:b.AjaxURL()+"&task=getItemsManagerData",sServerMethod:"POST",fnServerParams:function(a){var c=b.filter.apps?b.filter.apps:b.options.apps,
g=b.filter.types?b.filter.types:b.options.types,d=b.filter.cats?b.filter.cats:b.options.categories;tags=b.filter.tags?b.filter.tags:b.options.tags;a.push({name:"apps",value:b.options.apps});a.push({name:"types",value:b.options.types});a.push({name:"categories",value:b.options.categories});a.push({name:"tags",value:b.options.tags});a.push({name:"filter_apps",value:c});a.push({name:"filter_types",value:g});a.push({name:"filter_cats",value:d});a.push({name:"filter_tags",value:tags})},oLanguage:{sEmptyTable:b._("IM_NO_ITEMS_FOUND"),
sInfoEmpty:"",sInfo:b._("IM_PAGINATION_INFO")},aoColumns:[{sTitle:b._("NAME"),mData:"_itemname",sClass:"column-name",mRender:function(a,b,c){return"display"==b?"":a},fnCreatedCell:function(a,b,g,d,h){c(a).parent("tr").attr("data-id",g.id)}},{sTitle:"App",mData:"application",bSortable:!1,mRender:function(a,b,c){return"display"==b?a.name:a.id}},{sTitle:"Type",mData:"type",bSortable:!1,mRender:function(a,b,c){return"display"==b?a.name:a.id}},{sTitle:"Access",mData:"access",bSearchable:!1,bSortable:!1},
{sTitle:"Author",mData:"author",bSearchable:!1,bSortable:!1,mRender:function(a,b,c){return"display"==b?a.name:a.id}},{sTitle:"ID",mData:"id",bSearchable:!1,bSortable:!1},{sTitle:"",mData:"type",bSortable:!1,bSearchable:!1,sWidth:"14px",sClass:"column-icon",mRender:function(a,b,c){return"display"==b?'<i class="icon-file-alt"></i>':a}}],aoColumnDefs:[{bVisible:!1,aTargets:[1,2,3,4,5]}],fnInitComplete:function(e,f){var d=c(".zlux-x-filter-input_wrapper",a).append(c('<i class="icon-search" />'),c('<i class="icon-remove zlux-ui-dropdown-unselect" />').hide().on("click",
function(){c("input",d).val("");c(this).hide();b.oTable.fnFilter("")}));c("input",d).on("keyup",function(){""==c(this).val()?c(".zlux-ui-dropdown-unselect",d).hide():c(".zlux-ui-dropdown-unselect",d).show()});c("thead tr th:last",b.oTable).prependTo(c("thead tr",b.oTable));b.trigger("InitComplete")},fnRowCallback:function(a,f,d,k){f.dom=c(a);f.dom.addClass("zlux-object");c("td:last",f.dom).prependTo(f.dom);c(".column-name",f.dom).html("").removeClass("zlux-ui-open").append(b.renderObjectDOM(f))},
fnPreDrawCallback:function(a){b.zluxdialog.spinner("show");b.trigger("DTPreDrawCallback",a)},fnDrawCallback:function(a){var f=a.oInstance.fnPagingInfo(),d=c(".dataTables_paginate",c(a.nTableWrapper)).closest(".row-fluid");1>=f.iTotalPages&&d.hide()||d.show();b.zluxdialog.scrollbar("refresh");b.zluxdialog.spinner("hide");b.trigger("TableDrawCallback",a)}}).on("click",".zlux-object .zlux-x-name a",function(){var a=c(this).closest("tr.zlux-object"),f=b.oTable.fnGetData(a[0]);f.dom=a;b.trigger("ObjectSelected",
f);return!1})},renderObjectDOM:function(a){var b;b=[{name:this._("ROUTE"),value:a.application.name+" / "+a.type.name+" / ID "+a.id},{name:this._("ACCESS"),value:a.access},{name:this._("CREATED"),value:a.created}];a.author.name&&b.push({name:this._("AUTHOR"),value:a.author.name});var e="";c.each(b,function(a,b){e+="<li><strong>"+b.name+"</strong>: <span>"+b.value+"</span></li>"});return c('<div class="zlux-x-tools"><i class="zlux-x-details-btn icon-angle-down" /></div><div class="zlux-x-name"><a href="#" class="zlux-x-name-link">'+
a.name+'</a></div><div class="zlux-x-details"><div class="zlux-x-messages" /><div class="zlux-x-details-content"><ul class="unstyled">'+e+"</ul></div></div>")},reload:function(){this.oTable.fnReloadAjax()}});c.fn[d.prototype.name]=function(){var a=arguments,b=a[0]?a[0]:null;return this.each(function(){var e=c(this);if(d.prototype[b]&&e.data(d.prototype.name)&&"initialize"!=b)e.data(d.prototype.name)[b].apply(e.data(d.prototype.name),Array.prototype.slice.call(a,1));else if(!b||c.isPlainObject(b)){var f=
new d;d.prototype.initialize&&f.initialize.apply(f,c.merge([e],a));e.data(d.prototype.name,f)}else c.error("Method "+b+" does not exist on jQuery."+d.name)})};c.fn[d.prototype.name]=d;c.fn[d.prototype.name].iNextUnique=0})(jQuery);
(function(c){var d=function(a){this.options=c.extend({},c.fn.zluxItemsManager.prototype.options,this.options,a);this.events={}};d.prototype=c.extend(d.prototype,c.fn.zluxItemsManager.prototype,{name:"zluxDialogItemsManager",options:{title:"Items Manager",position:{},full_mode:0},events:{},initialize:function(a,b){this.options=c.extend({},this.options,b);var e=this;e.initCheck();e.filter={};e.dialogTrigger=a.on("click",function(){e.zluxdialog.toggle();return!1});e.initDialog();e.initMainEvents()},
initDialog:function(){var a=this;a.zluxdialog=(new c.fn.zluxDialog({title:a.options.title,width:a.options.full_mode?"75%":300,dialogClass:"zl-bootstrap zlux-itemsmanager "+(a.options.full_mode?"zlux-dialog-full":""),position:c.extend({of:a.dialogTrigger,my:"left top",at:"right bottom"},a.options.position)})).done(function(){a.zluxdialog.widget.attr("id","zluxItemsManager_"+a.ID);a.eventDialogLoaded()})},eventDialogLoaded:function(){var a=this;a.itemsmanager=c('<div class="zlux-itemsmanager" />').appendTo(a.zluxdialog.content);
a.initDataTable(a.itemsmanager);a.zluxdialog.main.on("click",".zlux-x-details-btn",function(){var b=c(this),e=b.closest("tr.zlux-object"),f=c("td.column-name",e),d=c(".zlux-x-details",e);f.hasClass("zlux-ui-open")?(b.addClass("icon-angle-down").removeClass("icon-angle-up"),f.removeClass("zlux-ui-open"),d.slideUp("fast",function(){a.zluxdialog.scrollbar("refresh")})):(f.addClass("zlux-ui-open"),b.removeClass("icon-angle-down").addClass("icon-angle-up"),a.zluxdialog.content.stop().animate({scrollTop:e.get(0).offsetTop},
900,"swing"),d.slideDown("fast",function(){a.zluxdialog.scrollbar("refresh")}))});c("html").on("mousedown",function(b){!a.zluxdialog.dialog("isOpen")||a.dialogTrigger.is(b.target)||a.dialogTrigger.find(b.target).length||a.zluxdialog.widget.find(b.target).length||a.zluxdialog.widget.is(b.target)||a.zluxdialog.dialog("close")});a.zluxdialog.setMainToolbar([{title:a._("APPLY_FILTERS"),icon:"filter",click:function(b){c(".zlux-dialog-subtoolbar-filter",a.zluxdialog.toolbar.wrapper).slideToggle("fast");
b.toggleClass("zlux-ui-tool-enabled")}},{title:a._("REFRESH"),icon:"refresh",click:function(){a.reload()}}]);a.zluxdialog.newSubToolbar("filter","main")},initMainEvents:function(){var a=this;a.bind("InitComplete",function(b){a.zluxdialog.scrollbar("refresh");var d=c(".zlux-dialog-subtoolbar-filter",a.zluxdialog.toolbar.wrapper);d.append(a.getSelect("aaApps",a._("IM_FILTER_BY_APP"),function(b){a.filter.apps=b;a.filter.types="";c(".btn-group[data-id=2]",d).attr("data-update",!0)},function(){a.filter.apps=
""}),a.getSelect("aaTypes",a._("IM_FILTER_BY_TYPE"),function(b){a.filter.types=b;c(".btn-group[data-id=2]",d).attr("data-update",!1)},function(){a.filter.types=""}),a.getSelect("aaCategories",a._("IM_FILTER_BY_CATEGORY"),function(b){a.filter.cats=b},function(){a.filter.cats=""}),a.getSelect("aaTags",a._("IM_FILTER_BY_TAG"),function(b){a.filter.tags=b},function(){a.filter.tags=""}));c(".zlux-x-filter-input_wrapper",a.oTable.fnSettings().nTableWrapper).appendTo(d);a.zluxdialog.initContent()});a.bind("ItemSelected",
function(a,c,d){d.siblings("[data-checked]").removeAttr("data-checked");input.val(c).trigger("change")});a.bind("ItemUnselected",function(a,c,d){input.val("").trigger("change")})},getSelect:function(a,b,d,f){var g=this,k=c.parseJSON(g.oTable.fnSettings().jqXHR.responseText)[a];if(!(1>=k.length)){var h=c('<a class="btn dropdown-toggle" data-toggle="dropdown" href="#">'+b+'<span class="caret" /></a>'),l=c('<ul class="dropdown-menu">'+g._getSelectOptions(k)+"</ul>"),m=c('<div class="btn-group" data-text="'+
b+'" />').append(h,l),n=c('<i class="icon-remove zlux-ui-dropdown-unselect" />').on("click",function(){h.html(b+'<span class="caret"></span>');n.hide();c.isFunction(f)&&f();g.reload()}).hide().prependTo(m);k.length||h.addClass("disabled");h.on("click",function(a){if(h.hasClass("disabled"))return!1});l.on("click","a",function(a){var f=c(this).data("value")?c(this).data("value"):"",p=b,p=c(this).text().replace(/^[^a-zA-Z]+/g,"").replace(/[^a-zA-Z]+$/g,"");n.show();h.html(p+'<span class="caret"></span>').data("selected-value",
f);c.isFunction(d)&&d(f);g.reload();a.preventDefault()});g.bind("TableDrawCallback",function(d,f){var e=c.parseJSON(g.oTable.fnSettings().jqXHR.responseText)[a];l.empty().append(g._getSelectOptions(e));e.length||m.addClass("disabled");var k=!1;c.each(e,function(a,b){b.id==h.data("selected-value")&&(k=!0)});k||(n.hide(),h.data("selected-value","").html(b+'<span class="caret"></span>'))});return m}},_getSelectOptions:function(a){var b,c=a.length,d=[];for(b=0;b<c;b++){var g='<li><a href="#" data-value="'+
a[b].id+'">'+a[b].name+"</a></li>";-1<jQuery.inArray(g,d)||d.push(g)}return d.join("")}});c.fn[d.prototype.name]=function(){var a=arguments,b=a[0]?a[0]:null;return this.each(function(){var e=c(this);if(d.prototype[b]&&e.data(d.prototype.name)&&"initialize"!=b)e.data(d.prototype.name)[b].apply(e.data(d.prototype.name),Array.prototype.slice.call(a,1));else if(!b||c.isPlainObject(b)){var f=new d;d.prototype.initialize&&f.initialize.apply(f,c.merge([e],a));e.data(d.prototype.name,f)}else c.error("Method "+
b+" does not exist on jQuery."+d.name)})}})(jQuery);