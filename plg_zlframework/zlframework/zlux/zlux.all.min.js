/* ===================================================
 * ZLUX Main
 * https://zoolanders.com/extensions/zl-framework
 * ===================================================
 * Copyright (C) JOOlanders SL 
 * http://www.gnu.org/licenses/gpl-2.0.html GNU/GPLv2 only
 * ========================================================== */
(function(a){var c=function(e){this.options=a.extend({},this.options,e);this.events={}};c.prototype=a.extend(c.prototype,{name:"zluxMain",options:{},events:{},createCache:function(e){var b={};return function(d,c){b[d]||(b[d]=a.Deferred(function(b){e(b,d)}).promise());return b[d].done(c)}},JRoot:function(){return a.fn[c.prototype.name].prototype.JRoot},AjaxURL:function(){return this.JRoot()+"index.php?option=com_zoo&controller=zlux&format=raw"},trigger:function(e){var b=this.events[e.toLowerCase()], d,a;if(b){a=Array.prototype.slice.call(arguments);a[0]=this;for(d=0;d<b.length;d++)if(!1===b[d].func.apply(b[d].scope,a))return!1}return!0},bind:function(e,b,d){var a;e=e.toLowerCase();a=this.events[e]||[];a.push({func:b,scope:d||this});this.events[e]=a;return this},unbind:function(e,b){e=e.toLowerCase();var d=this.events[e],a;if(d){if(b!==undef)for(a=d.length-1;0<=a;a--){if(d[a].func===b){d.splice(a,1);break}}else d=[];d.length||delete this.events[e]}},unbindAll:function(){var a=this;plupload.each(events, function(b,d){a.unbind(d)})},hasEventListener:function(a){return!!this.events[a.toLowerCase()]},sprintf:function(a){var b=[].slice.call(arguments,1),d="";a.split(/%[sdf]/).forEach(function(a){d+=a;b.length&&(d+=b.shift())});return d},_ErrorLog:function(a,b){var d=void 0===this.ID?this.name+": "+b:this.name+" warning (id = '"+this.ID+"'): "+b;0===a?alert(d):window.console&&console.log&&console.log(d)}});a.fn[c.prototype.name]=c})(jQuery); (function(a){var c=function(e){this.options=a.extend({},this.options,e);this.events={}};c.prototype=a.extend(c.prototype,a.fn.zluxMain.prototype,{name:"zluxManager",options:{},events:{},initialize:function(e,b){this.options=a.extend({},this.options,b)},reload:function(){var a=this.oTable.fnSettings();a.bReloading=!0;this.oTable.fnReloadAjax(a.sAjaxSource)},pushMessageToObject:function(e,b){"string"==typeof b?b=a("<div>"+b+"</div>"):1<b.length&&a.each(b,function(d,c){b[d]=a("<div>"+c+"</div>")});var d= a(".zlux-x-msg",e.dom),c=a('<div class="zlux-x-details-content zlux-x-msg" />').hide().append(b,a('<i class="zlux-x-msg-remove icon-remove" />').on("click",function(){c.fadeOut()})).prependTo(a(".zlux-x-details",e.dom)).slideDown("fast",function(){d.fadeOut("slow",function(){a(this).remove()})});return c},pushStorageData:function(a){"s3"==this.options.storage&&(a.push({name:"storage",value:"s3"}),a.push({name:"accesskey",value:this.options.storage_params.accesskey}),a.push({name:"key",value:this.options.storage_params.secretkey}), a.push({name:"bucket",value:this.options.storage_params.bucket}));return a}});a.fn[c.prototype.name]=function(){if(!this.data(c.prototype.name)){var e=arguments,b=e[0]?e[0]:null;return this.each(function(){var d=a(this);if(c.prototype[b]&&d.data(c.prototype.name)&&"initialize"!=b)d.data(c.prototype.name)[b].apply(d.data(c.prototype.name),Array.prototype.slice.call(e,1));else if(!b||a.isPlainObject(b)){var f=new c;c.prototype.initialize&&f.initialize.apply(f,a.merge([d],e));d.data(c.prototype.name, f)}else a.error("Method "+b+" does not exist on jQuery."+c.name)})}};a.fn[c.prototype.name]=c})(jQuery); (function(a){var c=function(){};c.prototype=a.extend(c.prototype,{name:"zluxSaveElement",options:{msgSaveElement:"Save Element",item_id:0,elm_id:""},initialize:function(c,b){this.options=a.extend({},this.options,b);var d=this;a('<a class="btn btn-small save" href="javascript:void(0);" />').append('<i class="icon-ok-sign"></i> '+d.options.msgSaveElement).on("click",function(){var b=a(this).addClass("btn-working"),c=b.closest(".element").find("input, textarea").serializeArray();a.post(d.AjaxUrl+"&task=saveelement&item_id="+ d.options.item_id+"&elm_id="+d.options.elm_id,c,function(){b.removeClass("btn-working")})}).appendTo(c.find(".btn-toolbar"))}});a.fn[c.prototype.name]=function(){var e=arguments,b=e[0]?e[0]:null;return this.each(function(){var d=a(this);if(c.prototype[b]&&d.data(c.prototype.name)&&"initialize"!=b)d.data(c.prototype.name)[b].apply(d.data(c.prototype.name),Array.prototype.slice.call(e,1));else if(!b||a.isPlainObject(b)){var f=new c;c.prototype.initialize&&f.initialize.apply(f,a.merge([d],e));d.data(c.prototype.name, f)}else a.error("Method "+b+" does not exist on jQuery."+c.name)})}})(jQuery); (function(a){var c=function(c){this.options=a.extend({},this.options,c);this.events={}};c.prototype=a.extend(c.prototype,a.fn.zluxMain.prototype,{name:"zluxExample",options:{param:""},events:{},initialize:function(c,b){this.options=a.extend({},a.fn.zluxMain.prototype.options,this.options,b)},some_function:function(){}});a.fn[c.prototype.name]=function(){var e=arguments,b=e[0]?e[0]:null;return this.each(function(){var d=a(this);if(c.prototype[b]&&d.data(c.prototype.name)&&"initialize"!=b)d.data(c.prototype.name)[b].apply(d.data(c.prototype.name), Array.prototype.slice.call(e,1));else if(!b||a.isPlainObject(b)){var f=new c;c.prototype.initialize&&f.initialize.apply(f,a.merge([d],e));d.data(c.prototype.name,f)}else a.error("Method "+b+" does not exist on jQuery."+c.name)})}})(jQuery);


/* ===================================================
 * ZLUX Dialog
 * https://zoolanders.com/extensions/zl-framework
 * Eg: new $.zluxDialog();
 * ===================================================
 * Copyright (C) JOOlanders SL 
 * http://www.gnu.org/licenses/gpl-2.0.html GNU/GPLv2 only
 * ========================================================== */
(function(b){var f=function(a){this.options=b.extend({},this.options,a);this.events={}};f.prototype=b.extend(f.prototype,b.fn.zluxMain.prototype,{name:"zluxDialog",options:{width:"300",height:"150",title:"Dialog"},events:{},initialize:function(a){this.options=b.extend({},this.options,a);this.creatingDialog=b.Deferred();return this.creatingDialog.promise(this)},initDialog:function(){var a=this;a.options.dialogClass="zlux-dialog "+a.options.dialogClass;a.main=b("<div />").appendTo(b("body")).dialog(b.extend({autoOpen:1, resizable:!1,height:"auto"},a.options));a.main.hide();a.content=b('<div class="zlux-dialog-content" />').appendTo(a.main);a.widget=a.main.dialog("widget");a.main.on("dialogopen",function(){a.widget.data("dialog-dragged")||a.widget.position(b.extend({my:"center",at:"center",of:window},a.options.position)).data("dialog-dragged",1)});a._spinner=b('<i class="zlux-loader-circle-big icon-spinner icon-spin" />').appendTo(a.widget);a._spinner_area=a.main;a.main.addClass("zlux-scroller").nanoScroller({preventPageScrolling:!0, contentClass:"zlux-dialog-content"});a.toolbar={};a.toolbar.wrapper=b('<div class="zlux-dialog-toolbar" />').hide().insertAfter(a.widget.children()[0]);b(".ui-dialog-titlebar-close",a.widget).html('<i class="icon-remove" />');a.creatingDialog.resolve()},initContent:function(){this.main.show();this.widget.attr("data-zlux-status","ready");this.scrollbar("refresh");this.inited=!0;this.spinner("hide")},toggle:function(){"pending"==this.creatingDialog.state()?this.initDialog():"resolved"==this.creatingDialog.state()&& this.dialog(this.dialog("isOpen")?"close":"open")},dialog:function(a){return this.main.dialog(a)},scrollbar:function(a){"refresh"==a?(a=b(".pane .slider",this.main),this.scrollbar("show"),this.main.nanoScroller(),a=Math.round(this.main.height())-Math.round(a.height()),0<=a&&5>=a&&this.scrollbar("hide")):"hide"==a?this.main.nanoScroller({stop:!0}):"show"==a?this.main.nanoScroller({stop:!1}):this.main.nanoScroller(a)},spinner:function(a){this.inited&&("show"==a?(this.main.fadeTo(0,0.5),this._spinner.show(), this.scrollbar("hide")):(this.scrollbar("show"),this._spinner.hide(),this.main.add(this.toolbar.wrapper).fadeTo("slow",1)))},newToolbar:function(a,c,d){var e=b('<div class="zlux-dialog-toolbar-'+c+'"><ul class="inline" /></div>').appendTo(this.toolbar.wrapper);b.each(a,function(a,c){b("ul",e).append(b("<li />").append(b('<i data-id="'+c.id+'" class="icon-'+c.icon+' icon-2x icon-border" title="'+c.title+'">'+(c.subicon?'<i class="icon-'+c.subicon+'"></i>':"")+"</i>").on("click",function(){if(b(this).hasClass("disabled"))return!1; c.click(b(this))})))});b(".zlux-dialog-toolbar-backtomain",this.toolbar.wrapper).on("click",function(){d()})},newSubToolbar:function(a,c){b('<div class="zlux-dialog-subtoolbar-'+a+'" />').hide().appendTo(b(".zlux-dialog-toolbar-"+c,this.toolbar.wrapper))},setMainToolbar:function(a){var c=this;c.newToolbar(a,"main");c.toolbar.wrapper.prepend(b('<i class="zlux-dialog-toolbar-backtomain icon-reply icon-border" title="Back to Main view" />').on("click",function(){b('[class^="zlux-dialog-toolbar-"]',c.toolbar.wrapper).hide(); b(".zlux-dialog-toolbar-main",c.toolbar.wrapper).show()}))},showToolbar:function(a){b(".zlux-dialog-toolbar-"+a,this.toolbar.wrapper).show();b(".zlux-dialog-toolbar-main",this.toolbar.wrapper).hide();b(".zlux-dialog-toolbar-backtomain",this.toolbar.wrapper).show()},toggleSubtoolbar:function(a,c){c=b(".zlux-dialog-toolbar-"+c,this.toolbar.wrapper);var d=b(".zlux-dialog-subtoolbar-"+a,c);d.siblings("div").slideUp("fast",function(){d.slideToggle("fast")})},toolbarBtnState:function(a,c,d){var e=b(".zlux-dialog-toolbar-"+ a+' i[data-id="'+c+'"]',this.toolbar.wrapper);"disabled"==d?e.animate({color:"#C0C0C0"},200,function(){e.addClass("disabled")}):e.animate({color:"#444"},200,function(){e.removeClass("disabled")})}});b.fn[f.prototype.name]=function(){var a=arguments,b=new f;if(f.prototype.initialize)return b.initialize.apply(b,a)}})(jQuery);


/* ===================================================
 * ZLUX Files Manager
 * https://zoolanders.com/extensions/zl-framework
 * ===================================================
 * Copyright (C) JOOlanders SL 
 * http://www.gnu.org/licenses/gpl-2.0.html GNU/GPLv2 only
 * ========================================================== */
(function(b){var f=function(a){this.options=b.extend({},this.options,a);this.events={}};f.prototype=b.extend(f.prototype,b.fn.zluxManager.prototype,{name:"zluxFilesManager",options:{root:"images",extensions:"",storage:"local",storage_params:{},max_file_size:""},events:{},initialize:function(a,c){this.options=b.extend({},this.options,c);this.initCheck();this.target=a;this.filesmanager=b('<div class="zl-bootstrap zlux-filesmanager" />').appendTo(a);this.initDataTable(this.filesmanager)},initCheck:function(){b.fn.zluxFilesManager.iNextUnique++;
this.ID=b.fn.zluxFilesManager.iNextUnique;this.options.max_file_size=plupload.parseSize(this.options.max_file_size);if(""==this.options.storage||void 0==this.options.storage||null==this.options.storage)this._ErrorLog(0,"Storage param missing, set by default to 'local'"),this.options.storage="local"},initDataTable:function(a){var c=this,d=c.AjaxURL()+"&task=getFilesManagerData";b('<table cellpadding="0" cellspacing="0" border="0" class="table table-striped table-bordered" />').appendTo(a);c.oTable=
b("table",a).dataTable({sDom:"F<'row-fluid'<'span12'B>><'row-fluid'<'span12't>>",oLanguage:{sEmptyTable:"No files found",sInfoEmpty:""},sAjaxUrl:c.AjaxURL(),sAjaxSource:d,sServerMethod:"POST",sStartRoot:c.cleanPath(c.options.root),bPaginate:!1,aoColumns:[{sTitle:"",mData:"type",bSearchable:!1,sWidth:"14px",sClass:"column-icon",mRender:function(a,b){return"display"==b?'<i class="icon-'+("folder"==a?"folder-close":"file-alt")+'"></i>':a}},{sTitle:"Name",mData:"name",sClass:"column-name",mRender:function(a,
b){return"display"==b?"":a},fnCreatedCell:function(a,d,h){b(a).parent("tr").attr("data-id",c.cleanPath(h.name))}}],aoColumnDefs:{bVisible:!1,aTargets:[2]},aaSorting:[[0,"desc"],[1,"asc"]],fnServerData:function(a,b,d,j){c._fnServerData(a,b,d,j)},fnServerParams:function(a){a.push({name:"extensions",value:c.options.extensions});"s3"==c.options.storage&&(a.push({name:"storage",value:"s3"}),a.push({name:"accesskey",value:c.options.storage_params.accesskey}),a.push({name:"key",value:c.options.storage_params.secretkey}),
a.push({name:"bucket",value:c.options.storage_params.bucket}))},fnRowCallback:function(a,d){d.dom=b(a);d.dom.attr("data-type",d.type).addClass("zlux-object");b(".column-name",d.dom).html("").removeClass("zlux-ui-open").append(c.renderObjectDOM(d));b(".zlux-x-name",d.dom).append('<i class="zlux-x-name-edit icon-edit-sign" />')},fnInitComplete:function(){var d=b(".zlux-x-filter-input_wrapper",a).append(b('<i class="icon-search" />'),b('<i class="icon-remove zlux-ui-dropdown-unselect" />').hide().on("click",
function(){b("input",d).val("");b(this).hide();c.oTable.fnFilter("")}));b("input",d).on("keyup",function(){""==b(this).val()?b(".zlux-ui-dropdown-unselect",d).hide():b(".zlux-ui-dropdown-unselect",d).show()});c.trigger("InitComplete")},fnPreDrawCallback:function(){c.zluxdialog.spinner("show")},fnDrawCallback:function(a){var d=a.oInstance.fnPagingInfo();a=b(".dataTables_paginate",b(a.nTableWrapper)).closest(".row-fluid");1>=d.iTotalPages&&a.hide()||a.show();c.zluxdialog.scrollbar("refresh");c.zluxdialog.spinner("hide")}}).on("click",
".zlux-object .zlux-x-name a",function(){var a=b(this).closest("tr.zlux-object"),d=c.oTable.fnGetData(a[0]),h=c.oTable.fnSettings();d.dom=a;"true"!=d.dom.attr("data-zlux-object-status")&&(d.dom.attr("data-zlux-object-status","true"),d.dom.siblings().removeAttr("data-zlux-object-status"),"folder"==d.dom.data("type")&&(c.oTable.fnSettings(),h.sGoToPath=d.dom.data("id"),c.oTable.fnReloadAjax(h.sAjaxSource)),c.trigger("ObjectSelected",d));return!1}).on("click",".zlux-object .zlux-x-remove",function(){var a=
b(this).closest("tr.zlux-object"),d=b("td",a),h=c.oTable.fnGetData(a[0]);h.dom=a;d.hasClass("zlux-ui-open")?c.trigger("BeforeDeleteFile",h):row.removeAttr("data-checked");return!1})},_fnServerData:function(a,c,d,e){var g=this,h;e.aAjaxDataCache=e.aAjaxDataCache?e.aAjaxDataCache:{};b.isEmptyObject(e.aAjaxDataCache)&&(e.sCurrentPath=e.oInit.sStartRoot);h=g.cleanPath(e.sCurrentPath+"/"+e.sGoToPath);e.sGoToPath="";c.push({name:"root",value:h});e.jqXHR=b.ajax({url:a,data:c,beforeSend:function(){var a=
!1;if(!e.bReloading){var c=e.aAjaxDataCache[h];c&&(e.sCurrentPath=h,b(e.oInstance).trigger("xhr",[e,c]),d(c),a=!0)}if(a)return!1;g.zluxdialog.spinner("show")},success:function(a){a.sError&&e.oApi._fnLog(e,0,a.sError);b.isEmptyObject(e.aAjaxDataCache)&&(e.oInit.sStartRoot=a.root);e.sCurrentPath=a.root;e.bReloading&&(e.aAjaxDataCache={});e.aAjaxDataCache[a.root]=a;e.bReloading=!1;b(e.oInstance).trigger("xhr",[e,a]);d(a)},dataType:"json",cache:!1,type:e.sServerMethod,error:function(a,b){"parsererror"==
b&&e.oApi._fnLog(e,0,"DataTables warning: JSON data from server could not be parsed. This is caused by a JSON formatting error.")}})},_getFullPath:function(a){var b=this.oTable.fnSettings().sCurrentPath;return b?b+"/"+a:a},cleanPath:function(a){return a.replace(/undefined/g,"").replace(/\/\//g,"/").replace(/(^\/|\/$)/g,"")},_getRowFromPath:function(a){return b('tr[data-path="'+a+'"]',this.oTable)},renderObjectDOM:function(a){var c="";b.each("folder"==a.type?[{name:"Name",value:a.basename}]:[{name:"Name",
value:a.basename},{name:"Type",value:a.content_type},{name:"Size",value:a.size.display}],function(a,b){c+="<li><strong>"+b.name+"</strong>: <span>"+b.value+"</span></li>"});return b('<div class="zlux-x-tools"><i class="zlux-x-details-btn icon-angle-down" /><i class="zlux-x-remove icon-minus-sign" /></div><div class="zlux-x-name"><a href="#" class="zlux-x-name-link">'+a.name+'</a></div><div class="zlux-x-details"><div class="zlux-x-messages" /><div class="zlux-x-details-content"><ul class="unstyled">'+
c+"</ul></div></div>")},deleteObjectFile:function(a){var c=this,d=[],e=c._getFullPath(a.name),d=c.pushStorageData(d);"s3"==c.options.storage&&"folder"==a.type&&(e+="/");d.push({name:"path",value:e});return b.Deferred(function(a){b.ajax({url:c.AjaxURL()+"&task=deleteObject",data:d,dataType:"json",type:"post"}).done(function(b){b.result?(a.resolve(),c.trigger("FileDeleted",e)):a.reject(b.errors)}).fail(function(){a.reject("Something went wrong, the task was not performed.")})}).promise()},createFolder:function(a){var c=
this,d=[];a=c._getFullPath(a);d=c.pushStorageData(d);"s3"==c.options.storage&&(a+="/");d.push({name:"path",value:a});return b.Deferred(function(a){b.ajax({url:c.AjaxURL()+"&task=newFolder",data:d,dataType:"json",type:"post"}).done(function(b){b.result?a.resolve(b.name):a.reject(b.errors)}).fail(function(){a.reject("Something went wrong, the task was not performed.")})}).promise()},renameObject:function(a){var c=this,d=b(".zlux-x-name a",a.dom),e=d.html().match(/\.+[a-zA-Z]+$/g),g=d.html().replace(/\.+[a-zA-Z]+$/g,
""),e=null!==e?e:"",h=b('<div>Input the new name <br /><input class="zlux-x-input" type="text" value="'+g+'" /> '+e+'<br />and <span class="label label-success label-link">confirm</span></div>').on("click",".label-link",function(){b(this).data("submited")||(b(this).data("submited",!0),b(".column-icon i",a.dom).addClass("icon-spinner icon-spin"),c._changeObjectName(a,b("input",h).val()+e).done(function(c){d.html(c);b(".zlux-x-details-content ul li:first span",a.dom).html(c);a.dom.attr("data-id",c);
a.name=c;a.basename=c.replace(/\.+[a-zA-Z]+$/g,"");a.path=a.path.replace(/(\w|[-.])+$/,c);b(".zlux-x-msg",a.dom).remove()}).fail(function(b){c.pushMessageToObject(a,b)}).always(function(){b(".column-icon i",a.dom).removeClass("icon-spinner icon-spin")}))}).on("keypress","input",function(a){13==(a.keyCode?a.keyCode:a.which)&&b(".label-link",h).trigger("click")});c.pushMessageToObject(a,h)},_changeObjectName:function(a,c){var d=this,e=[],g=d._getFullPath(a.name);dest=d._getFullPath(c);e=d.pushStorageData(e);
"s3"==d.options.storage&&"folder"==a.type&&(g+="/",dest+="/");e.push({name:"src",value:g});e.push({name:"dest",value:dest});return b.Deferred(function(a){b.ajax({url:d.AjaxURL()+"&task=moveObject",data:e,dataType:"json",type:"post"}).done(function(b){b.result?a.resolve(b.name):a.reject(b.errors)}).fail(function(){a.reject("Something went wrong, the task was not performed.")})}).promise()}});b.fn[f.prototype.name]=function(){var a=arguments,c=a[0]?a[0]:null;return this.each(function(){var d=b(this);
if(f.prototype[c]&&d.data(f.prototype.name)&&"initialize"!=c)d.data(f.prototype.name)[c].apply(d.data(f.prototype.name),Array.prototype.slice.call(a,1));else if(!c||b.isPlainObject(c)){var e=new f;f.prototype.initialize&&e.initialize.apply(e,b.merge([d],a));d.data(f.prototype.name,e)}else b.error("Method "+c+" does not exist on jQuery."+f.name)})};b.fn[f.prototype.name]=f;b.fn[f.prototype.name].iNextUnique=0})(jQuery);
(function(b){var f=function(a){this.options=b.extend({},this.options,a);this.events={}};f.prototype=b.extend(f.prototype,b.fn.zluxFilesManager.prototype,{name:"zluxDialogFilesManager",options:{title:"Files Manager",full_mode:0},events:{},initialize:function(a,c){this.options=b.extend({},b.fn.zluxFilesManager.prototype.options,this.options,c);var d=this;d.initCheck();d.dialogTrigger=b('<a title="'+d.options.title+'" class="btn btn-mini zlux-btn-edit" href="#"><i class="icon-edit"></i></a>').insertAfter(a).on("click",
function(){d.zluxdialog.toggle();return!1});d.initDialog();d.initMainEvents()},initDialog:function(){var a=this;a.zluxdialog=b.fn.zluxDialog({title:a.options.title,width:a.options.full_mode?"75%":300,dialogClass:"zl-bootstrap zlux-filesmanager "+(a.options.full_mode?"zlux-dialog-full":""),position:!1==a.options.full_mode?{of:a.dialogTrigger,my:"left top",at:"right bottom"}:null}).done(function(){a.zluxdialog.widget.attr("id","zluxFilesManager_"+a.ID);a.eventDialogLoaded()})},eventDialogLoaded:function(){var a=
this;a.filesmanager=b('<div class="zlux-filesmanager" />').appendTo(a.zluxdialog.content);a.initDataTable(a.filesmanager);a.zluxdialog.main.on("click",".zlux-x-details-btn",function(){var c=b(this),d=c.closest("tr.zlux-object"),e=b("td.column-name",d),g=b(".zlux-x-details",d);e.hasClass("zlux-ui-open")?(c.addClass("icon-angle-down").removeClass("icon-angle-up"),e.removeClass("zlux-ui-open"),g.slideUp("fast",function(){a.zluxdialog.scrollbar("refresh")})):(e.addClass("zlux-ui-open"),c.removeClass("icon-angle-down").addClass("icon-angle-up"),
a.zluxdialog.content.stop().animate({scrollTop:d.get(0).offsetTop},900,"swing"),g.slideDown("fast",function(){a.zluxdialog.scrollbar("refresh")}))});a.zluxdialog.main.on("click",".icon-edit-sign",function(){var c=b(this).closest("tr.zlux-object");$object=a.oTable.fnGetData(c[0]);$object.dom=c;a.renameObject($object)});b("html").on("mousedown",function(b){a.zluxdialog.dialog("isOpen")&&!a.dialogTrigger.is(b.target)&&!a.dialogTrigger.find(b.target).length&&!a.zluxdialog.widget.find(b.target).length&&
a.zluxdialog.dialog("close")});a.initMainToolbar();a.zluxdialog.newSubToolbar("filter","main");a.zluxdialog.newSubToolbar("newfolder","main");a.initUploader();a.zluxdialog.newToolbar([{title:"Add new files to upload",icon:"plus-sign",id:"add",click:function(){b(".zlux-upload-browse",a.zluxupload.upload).siblings(".moxie-shim").children("input").trigger("click")}},{title:"Start uploading",icon:"upload disabled",id:"start",click:function(){a.zluxupload.uploader.start();return!1}},{title:"Cancel current upload",
icon:"ban-circle disabled",id:"cancel",click:function(){a.zluxupload.uploader.stop();a.zluxdialog.toolbarBtnState(2,"ban-circle","disabled");a.zluxdialog.toolbarBtnState(2,"upload","enabled");a.zluxdialog.toolbarBtnState(2,"plus-sign","enabled")}}],2,function(){b(".zlux-upload",a.zluxdialog.content).fadeOut("400",function(){a.zluxupload.emptyQueue();b(".zlux-filesmanager",a.zluxdialog.content).fadeIn("400");a.zluxdialog.scrollbar("refresh")})})},initMainEvents:function(){var a=this;a.bind("InitComplete",
function(){a.zluxdialog.scrollbar("refresh");var c=b(".zlux-dialog-subtoolbar-filter",a.zluxdialog.toolbar.wrapper);b(".zlux-x-filter-input_wrapper",a.oTable.fnSettings().nTableWrapper).appendTo(c);a.zluxdialog.initContent()}).bind("BeforeDeleteFile",function(c,d){if(!b(".zlux-x-details-message-actions")[0]){var e=b('<div>You are about to delete this file, please <span class="label label-warning label-link">confirm</span></div>').on("click",".label-link",function(){b(this).data("submited")||(b(this).data("submited",
!0),b(".column-icon i",d.dom).addClass("icon-spinner icon-spin"),a.deleteObjectFile(d).done(function(){d.dom.fadeOut("slow",function(){b(this).remove();var c=a.oTable.fnSettings().aAjaxDataCache[a.oTable.fnSettings().sCurrentPath].aaData;b.each(c,function(a,b){if(d.dom.data("id")==b.name&&d.dom.data("type")==b.type)return c.splice(a,1),!1})})}).fail(function(b){a.pushMessageToObject(d,b)}).always(function(){b(".column-icon i",d.dom).removeClass("icon-spinner icon-spin")}))});a.pushMessageToObject(d,
e)}})},initMainToolbar:function(){var a=this;a.zluxdialog.setMainToolbar([{title:"Apply Filters",icon:"filter",click:function(b){a.zluxdialog.toggleSubtoolbar("filter","main");b.parent().siblings().children("i").not(b).removeClass("zlux-ui-tool-enabled");b.toggleClass("zlux-ui-tool-enabled")}},{title:"New folder",icon:"folder-close",subicon:"plus-sign",click:function(c){a.zluxdialog.toggleSubtoolbar("newfolder","main");b(".zlux-dialog-subtoolbar-newfolder",a.zluxdialog.toolbar.wrapper).html("").append(b('<input type="text" class="zlux-x-input" placeholder="Folder name" />').on("keypress",
function(c){if(13==(c.keyCode?c.keyCode:c.which))a.createFolder(b(this).val()),a.zluxdialog.spinner("show"),a.createFolder(b(this).val()).always(function(){a.reload()})}));c.parent().siblings().children("i").not(c).removeClass("zlux-ui-tool-enabled");c.toggleClass("zlux-ui-tool-enabled")}},{title:"Upload files to current folder",icon:"cloud-upload",click:function(){a.zluxdialog.showToolbar(2);a.zluxdialog.scrollbar("hide");b(".zlux-filesmanager",a.zluxdialog.content).fadeOut("400",function(){a.zluxupload.inited||
a.zluxupload.init();a.zluxupload.options.path=a.oTable.fnSettings().sCurrentPath;b(".zlux-upload",a.zluxdialog.content).fadeIn("400")})}},{title:"Refresh",icon:"refresh",click:function(){a.reload()}}])},initUploader:function(){var a=this;a.zluxupload=new b.fn.zluxUpload({path:"images",wrapper:a.zluxdialog.content,storage:a.options.storage,storage_params:a.options.storage_params,max_file_size:a.options.max_file_size,extensions:a.options.extensions});a.zluxupload.bind("QueueChanged",function(){a.zluxdialog.scrollbar("refresh")}).bind("FilesAdded",
function(c,d){a.zluxdialog.toolbarBtnState(2,"upload","enabled");c.filelist.show();b.each(d,function(d,g){g.status="validating";var h={name:g.name,basename:g.name.replace(/(\.[a-z0-9]+)$/,""),type:"file",content_type:g.type,size:{size:g.size,display:plupload.formatSize(g.size)}};h.dom=b('<tr id="'+g.id+'" class="zlux-object" data-zlux-status="validating" />').append(b('<td class="column-icon" />').append('<i class="icon-file-alt zlux-x-object-icon" />'),b('<td class="column-name" />').append(a.renderObjectDOM(h))).appendTo(c.filelist);
b(".zlux-x-tools",h.dom).append(b('<span class="zlux-upload-file-progress"/>'));b(".zlux-x-name",h.dom).html(g.name);if(void 0!==g.size&&g.size>a.options.max_file_size){b(".icon-file-alt",h.dom).removeClass("icon-file-alt").addClass("icon-warning-sign");var f=a.pushMessageToObject(h,"File size error.<br />The file exceeds the maximum allowed size of "+plupload.formatSize(a.options.max_file_size));b(".zlux-x-msg-remove",f).remove();return!0}b.ajax({url:a.AjaxURL()+"&task=validateObjectName",type:"post",
data:{name:g.name},dataType:"json",cache:!1,beforeSend:function(){b(".column-icon i",h.dom).addClass("icon-spinner icon-spin")},success:function(a){b(".zlux-x-name",h.dom).html(a.result);g.name=a.result;g.status=1;c._handleFileStatus(g);b(".column-icon i",h.dom).removeClass("icon-spinner icon-spin");c._updateFilelist()}})})}).bind("BeforeUpload",function(){a.zluxdialog.toolbarBtnState(2,"cancel","enabled");a.zluxdialog.toolbarBtnState(2,"start","disabled");a.zluxdialog.toolbarBtnState(2,"add","disabled")}).bind("FileUploaded",
function(a,d){b(".zlux-x-name",d.dom).html(d.name);b(".zlux-upload-file-progress",d.dom).html("100%").fadeOut();b(".zlux-x-object-icon",d.dom).removeClass("icon-file-alt").addClass("icon-ok")}).bind("FileNotUpload",function(c,d,e){a.zluxdialog.toolbarBtnState(2,"cancel","disabled");a.zluxdialog.toolbarBtnState(2,"start","disabled");a.zluxdialog.toolbarBtnState(2,"add","enabled");b(".zlux-upload-file-progress",d.dom).fadeOut();b(".zlux-x-object-icon",d.dom).removeClass("icon-file-alt").addClass("icon-warning-sign");
c=a.pushMessageToObject(d,e);b(".zlux-x-msg-remove",c).remove()}).bind("UploadComplete",function(){a.zluxdialog.toolbarBtnState(2,"cancel","disabled");a.zluxdialog.toolbarBtnState(2,"start","disabled");a.zluxdialog.toolbarBtnState(2,"add","enabled");a.reload()}).bind("CancelUpload",function(){a.zluxdialog.toolbarBtnState(2,"cancel","disabled");a.zluxdialog.toolbarBtnState(2,"add","enabled")}).bind("QueueChanged",function(c,d){var e=!1;b.each(d,function(a,b){b.status!=plupload.DONE&&"validating"!=
b.status&&(e=!0)});d.length?e?a.zluxdialog.toolbarBtnState(2,"start","enabled"):a.zluxdialog.toolbarBtnState(2,"start","disabled"):a.zluxdialog.toolbarBtnState(2,"start","disabled")})}});b.fn[f.prototype.name]=function(){var a=arguments,c=a[0]?a[0]:null;return this.each(function(){var d=b(this);if(f.prototype[c]&&d.data(f.prototype.name)&&"initialize"!=c)d.data(f.prototype.name)[c].apply(d.data(f.prototype.name),Array.prototype.slice.call(a,1));else if(!c||b.isPlainObject(c)){var e=new f;f.prototype.initialize&&
e.initialize.apply(e,b.merge([d],a));d.data(f.prototype.name,e)}else b.error("Method "+c+" does not exist on jQuery."+f.name)})}})(jQuery);
(function(b){var f=function(a){this.options=b.extend({},this.options,a);this.events={}};f.prototype=b.extend(f.prototype,b.fn.zluxMain.prototype,{name:"zluxUpload",options:{extensions:"",path:null,fileMode:"files",max_file_size:"1024kb",wrapper:null,storage:"local",storage_params:{}},init:function(){var a=this;a.upload=b('<div class="zlux-upload" />').attr("data-zlux-status","").appendTo(a.options.wrapper).hide();a.dropzone=b('<div class="zlux-upload-dropzone" />').appendTo(a.upload).append(b('<span class="zlux-upload-dropzone-msg">Drop files here<br />or <a class="zlux-upload-browse" href="javascript:;">browse & choose</a> them</span>'));
a.initDnDevents();a.bind("WindowDragHoverStart",function(){a.dropzone.attr("data-zlux-draghover",!0)});a.bind("WindowDragHoverEnd",function(){a.dropzone.attr("data-zlux-draghover",!1)});a.initFilelist();a.bind("FileError",function(c,d,e){a.uploading&&"pending"==a.uploading.state()?a.uploading.reject(e):(b(".zlux-x-object-icon",d.dom).removeClass("icon-file-alt").addClass("icon-warning-sign"),c=a.pushMessageToObject(d,e),b(".zlux-x-msg-remove",c).remove())});a.initPlupload();a.inited=!0},initFilelist:function(){var a=
this;a.filelist=b('<table cellpadding="0" cellspacing="0" border="0" class="table table-striped table-bordered zlux-upload-filelist"><tbody /></table>').appendTo(a.upload).on("click",".zlux-x-remove",function(){if("uploding"!=b(this).closest(".zlux-object").data("zlux-status")){var c=b(this).closest(".zlux-object"),d=a.uploader.getFile(c[0].id);if("undefined"==d||d.zlux_status!=plupload.STARTED&&d.status!=plupload.UPLOADING)a.uploader.removeFile(d),c.remove()}})},initPlupload:function(){var a=this,
c;c={runtimes:"html5",browse_button:b(".zlux-upload-browse",a.upload)[0],drop_element:a.dropzone[0],max_file_size:void 0,url:a.AjaxURL()+"&task=upload",filters:[{title:"Files",extensions:this.options.extensions}],flash_swf_url:a.JRoot()+"plugins/system/zlframework/zlframework/zlux/assets/plupload/Moxie.swf"};"s3"==a.options.storage&&(c=b.extend(c,{url:"http://"+a.options.storage_params.bucket+".s3.amazonaws.com",multipart:!0,multipart_params:{key:"${filename}",Filename:"${filename}",acl:"public-read",
success_action_status:"201",AWSAccessKeyId:a.options.storage_params.accesskey,policy:a.options.storage_params.policy,signature:a.options.storage_params.signature},file_data_name:"file"}));c=b.extend(c,{init:{BeforeUpload:function(b,c){a.eventBeforeUpload(c)},UploadFile:function(b,c){a.eventUploadFile(c)},UploadProgress:function(b,c){a.eventUploadProgress(c)},FileUploaded:function(b,c,g){a.eventFileUploaded(c,g)},UploadComplete:function(b,c){a.eventUploadComplete(c)},CancelUpload:function(){a.eventCancelUpload()},
FilesAdded:function(b,c){a.eventFilesAdded(c)},QueueChanged:function(){a.eventQueueChanged()},StateChanged:function(){a.eventStateChanged()},Error:function(b,c){a.eventError(c)}}});a.uploader=new plupload.Uploader(c);a.uploader.bind("Init",function(){a.trigger("Init")});a.uploader.init()},_:function(a){return plupload.translate(a)||a},eventError:function(a){var c=a.file,d,e;if(c){d="<strong>"+a.message+"</strong>";if(e=a.details)d+=" <br /><i>"+a.details+"</i>";else{switch(a.code){case plupload.FILE_EXTENSION_ERROR:e=
this._("File: %s").replace("%s",c.name);break;case plupload.FILE_SIZE_ERROR:e=this.sprintf(this._("File: %s, size: %d, max file size: %d"),c.name,c.size,plupload.parseSize(this.options.max_file_size));break;case plupload.FILE_DUPLICATE_ERROR:e=this._("%s already present in the queue.").replace(/%s/,c.name);break;case plupload.FILE_COUNT_ERROR:e=this._("Upload element accepts only %d file(s) at a time. Extra files were stripped.").replace("%d",this.options.max_file_count);break;case plupload.IMAGE_FORMAT_ERROR:e=
this._("Image format either wrong or not supported.");break;case plupload.IMAGE_MEMORY_ERROR:e=this._("Runtime ran out of available memory.");break;case plupload.HTTP_ERROR:e="s3"==this.options.storage?this.options.storage_params.bucket.match(/\./g)?this._("The bucket name can't contain periods (.)."):this._("There is some missconfiguration with the Bucket. Checkout the CORS permissions. If the bucket is recently created 24h must pass because of Amazon redirections."):this._("Upload URL might be wrong or doesn't exist.")}d+=
" <br /><i>"+e+"</i>"}c.dom=b("#"+c.id,this.filelist);this.trigger("FileError",c,d)}},eventStateChanged:function(){this.uploader.state===plupload.UPLOADING&&this.upload.attr("data-zlux-status","uploading");this.uploader.state===plupload.STOPPED&&(this.upload.attr("data-zlux-status","stopped"),this._updateFilelist())},eventBeforeUpload:function(a){var c=b("#"+a.id,this.filelist);"local"==this.options.storage&&(this.uploader.settings.url=this.uploader.settings.url+"&path="+this.options.path);"s3"==
this.options.storage&&(this.uploader.settings.multipart_params.key=(this.options.path?this.options.path+"/":"")+a.name);b(".zlux-upload-file-progress",c).html("0%");a.zlux_status=2;this._handleFileStatus(a);b(".zlux-upload-file-btn-remove",c).removeClass("icon-remove").addClass("icon-spinner icon-spin");this.trigger("BeforeUpload",a)},eventUploadFile:function(a){var c=this;a.dom=b("#"+a.id,c.filelist);c.uploading=b.Deferred().fail(function(b){c.trigger("FileNotUpload",a,b)}).done(function(b){a.name=
b;c.trigger("FileUploaded",a)}).always(function(){c._handleFileStatus(a)})},eventUploadProgress:function(a){var c=isNaN(a.percent)?0:a.percent;b("#"+a.id+" .zlux-upload-file-progress",this.filelist).html(c+"%");this._handleFileStatus(a)},eventFileUploaded:function(a,c){b("#"+a.id,this.filelist);if("local"==this.options.storage){var d=b.parseJSON(c.response);d.error?this.uploading.reject(d.error.message):this.uploading.resolve(d.result)}else"s3"==this.options.storage&&(d=b(c.response),this.uploading.resolve(d.find("Key").html()))},
eventUploadComplete:function(a){this.trigger("UploadComplete",a)},eventCancelUpload:function(){this.trigger("CancelUpload")},eventFilesAdded:function(a){this.trigger("FilesAdded",a)},eventQueueChanged:function(){this._updateFilelist()},getQueuedFiles:function(){var a=[];b.each(this.uploader.files,function(b,d){d.status!=plupload.DONE&&"validating"!=d.status&&a.push(d)});return a},emptyQueue:function(){this.uploader.splice();this.filelist.empty()},_updateFilelist:function(){var a=this,c=!1;b.each(a.uploader.files,
function(b,e){e.status!=plupload.DONE&&"validating"!=e.status&&(c=!0);e.status==plupload.STOPPED&&a._handleFileStatus(e)});a.uploader.files.length&&b(".zlux-upload-dropzone-msg",a.upload).hide();a.uploader.files.length?c?a.upload.attr("data-zlux-status","queued"):a.upload.attr("data-zlux-status","stopped"):(a.upload.attr("data-zlux-status",""),b(".zlux-upload-dropzone-msg",a.upload).fadeIn());a.trigger("QueueChanged",a.uploader.files)},_handleFileStatus:function(a){var c=b("#"+a.id,this.filelist),
d="";a.zlux_status==plupload.STARTED?(d="started",a.zlux_status=""):(a.status==plupload.DONE&&(d="done"),a.status==plupload.FAILED&&(d="failed"),a.status==plupload.QUEUED&&(d="queued"),a.status==plupload.UPLOADING&&(d="uploading"),a.status==plupload.STOPPED&&b(".zlux-upload-file-progress",c).html(""));c.attr("data-zlux-status",d)},initDnDevents:function(){var a=this,c=b(),d=b(),e=!1;inDZ=!1;b(window).on("drop",function(a){a.preventDefault();return!1}).on("dragenter",function(b){0===c.size()&&(a.trigger("WindowDragHoverStart"),
e=!0,inDZ=!1);c=c.add(b.target)}).on("dragleave drop",function(g){setTimeout(function(){var a=!1;try{a=b("body").find(g.relatedTarget).length?!0:a}catch(d){}c=c.not(g.target);0===c.size()&&!a&&(e=!1)},1);setTimeout(function(){!e&&!inDZ&&(a.trigger("WindowDragHoverEnd"),d=b(),c=b())},2)});a.dropzone.on("dragenter",function(b){0===d.size()&&(a.trigger("WindowDragHoverStart"),e=!1,inDZ=!0);d=d.add(b.target)});a.dropzone.on("dragleave drop",function(f){setTimeout(function(){var a=!1;try{a=b("body").find(f.relatedTarget).length?
!0:a}catch(c){}d=d.not(f.target);0===d.size()&&!a&&(inDZ=!1)},1);setTimeout(function(){!e&&!inDZ&&(a.trigger("WindowDragHoverEnd"),d=b(),c=b())},2)})}});b.fn[f.prototype.name]=f})(jQuery);
(function(b){var f=function(a){this.options=b.extend({},this.options,a);this.events={}};f.prototype=b.extend(f.prototype,b.fn.zluxMain.prototype,{name:"zluxPreview",options:{},events:{},initialize:function(a,c){this.options=b.extend({},this.options,c);this.creatingDialog=b.Deferred();return this.creatingDialog.promise(this)},renderPreviewDOM:function(a,c){var d,e=[];c=void 0==c?!1:c;a.size=void 0==a.size?!1:a.size;e.push({name:"name",value:a.basename});"folder"==a.type?d='<span class="zlux-x-folder"></span>':
(d=c?'<div class="zlux-x-image"><img src="'+this.JRoot()+a.path+'" /></div>':'<span class="zlux-x-filetype">'+a.ext+"</span>",a.size&&e.push({name:"size",value:a.size.display}));var f="";b.each(e,function(a,b){f+="<li>"+b.value+"</li>"});return b('<div class="zlux-preview"><div class="zlux-x-thumbnail">'+d+'</div><ul class="zlux-x-details unstyled">'+f+"</ul></div>")}});b.fn[f.prototype.name]=function(){var a=arguments,b=new f;if(f.prototype.initialize)return b.initialize.apply(b,a)}})(jQuery);


/* ===================================================
 * ZLUX Items Manager
 * https://zoolanders.com/extensions/zl-framework
 * ===================================================
 * Copyright (C) JOOlanders SL 
 * http://www.gnu.org/licenses/gpl-2.0.html GNU/GPLv2 only
 * ========================================================== */
(function(c){var d=function(a){this.options=c.extend({},this.options,a);this.events={}};d.prototype=c.extend(d.prototype,c.fn.zluxManager.prototype,{name:"zluxItemsManager",options:{apps:"",types:"",categories:"",tags:""},initialize:function(a,b){this.options=c.extend({},this.options,b);this.filter={};this.initCheck();this.target=a;this.filesmanager=c('<div class="zl-bootstrap zlux-itemsmanager" />').appendTo(a);this.initDataTable(this.filesmanager)},initCheck:function(){c.fn.zluxItemsManager.iNextUnique++;
this.ID=c.fn.zluxItemsManager.iNextUnique},initDataTable:function(a){var b=this;c('<table cellpadding="0" cellspacing="0" border="0" class="table table-striped table-bordered" />').appendTo(a);b.oTable=c("table",a).dataTable({sDom:"F<'row-fluid'<'span12't>><'row-fluid'<'span12'p>><'row-fluid zlux-x-info'<'span12'i>>",bServerSide:!0,iDisplayLength:20,sAjaxSource:b.AjaxURL()+"&task=ItemsManager",fnServerParams:function(a){var c=b.filter.apps?b.filter.apps:b.options.apps,d=b.filter.types?b.filter.types:
b.options.types,h=b.filter.cats?b.filter.cats:b.options.categories;tags=b.filter.tags?b.filter.tags:b.options.tags;a.push({name:"apps",value:b.options.apps});a.push({name:"types",value:b.options.types});a.push({name:"categories",value:b.options.categories});a.push({name:"tags",value:b.options.tags});a.push({name:"filter_apps",value:c});a.push({name:"filter_types",value:d});a.push({name:"filter_cats",value:h});a.push({name:"filter_tags",value:tags})},oLanguage:{sEmptyTable:"No items found",sInfoEmpty:"",
sInfo:"Showing _START_ to _END_ of _TOTAL_ items"},aoColumns:[{sTitle:"Name",mData:"_itemname",sClass:"column-name",mRender:function(a,b){return"display"==b?"":a},fnCreatedCell:function(a,b,d){c(a).parent("tr").attr("data-id",d.id)}},{sTitle:"App",mData:"application",bSortable:!1,mRender:function(a,b){return"display"==b?a.name:a.id}},{sTitle:"Type",mData:"type",bSortable:!1,mRender:function(a,b){return"display"==b?a.name:a.id}},{sTitle:"Access",mData:"access",bSearchable:!1,bSortable:!1},{sTitle:"Author",
mData:"author",bSearchable:!1,bSortable:!1,mRender:function(a,b){return"display"==b?a.name:a.id}},{sTitle:"ID",mData:"id",bSearchable:!1,bSortable:!1},{sTitle:"",mData:"type",bSortable:!1,bSearchable:!1,sWidth:"14px",sClass:"column-icon",mRender:function(a,b){return"display"==b?'<i class="icon-file-alt"></i>':a}}],aoColumnDefs:[{bVisible:!1,aTargets:[1,2,3,4,5]}],fnInitComplete:function(){var e=c(".zlux-x-filter-input_wrapper",a).append(c('<i class="icon-search" />'),c('<i class="icon-remove zlux-ui-dropdown-unselect" />').hide().on("click",
function(){c("input",e).val("");c(this).hide();b.oTable.fnFilter("")}));c("input",e).on("keyup",function(){""==c(this).val()?c(".zlux-ui-dropdown-unselect",e).hide():c(".zlux-ui-dropdown-unselect",e).show()});c("thead tr th:last",b.oTable).prependTo(c("thead tr",b.oTable));b.trigger("InitComplete")},fnRowCallback:function(a,f){f.dom=c(a);f.dom.addClass("zlux-object");c("td:last",f.dom).prependTo(f.dom);c(".column-name",f.dom).html("").removeClass("zlux-ui-open").append(b.renderObjectDOM(f))},fnPreDrawCallback:function(a){b.zluxdialog.spinner("show");
b.trigger("DTPreDrawCallback",a)},fnDrawCallback:function(a){var f=a.oInstance.fnPagingInfo(),d=c(".dataTables_paginate",c(a.nTableWrapper)).closest(".row-fluid");1>=f.iTotalPages&&d.hide()||d.show();b.zluxdialog.scrollbar("refresh");b.zluxdialog.spinner("hide");b.trigger("TableDrawCallback",a)}}).on("click",".zlux-object .zlux-x-name a",function(){var a=c(this).closest("tr.zlux-object"),d=b.oTable.fnGetData(a[0]);d.dom=a;b.trigger("ObjectSelected",d);return!1})},renderObjectDOM:function(a){var b;
b=[{name:"Route",value:a.application.name+" / "+a.type.name+" / ID "+a.id},{name:"Access",value:a.access},{name:"Created",value:a.created}];a.author.name&&b.push({name:"Author",value:a.author.name});var e="";c.each(b,function(a,b){e+="<li><strong>"+b.name+"</strong>: <span>"+b.value+"</span></li>"});return c('<div class="zlux-x-tools"><i class="zlux-x-details-btn icon-angle-down" /></div><div class="zlux-x-name"><a href="#" class="zlux-x-name-link">'+a.name+'</a></div><div class="zlux-x-details"><div class="zlux-x-messages" /><div class="zlux-x-details-content"><ul class="unstyled">'+
e+"</ul></div></div>")},reload:function(){this.oTable.fnReloadAjax()}});c.fn[d.prototype.name]=function(){var a=arguments,b=a[0]?a[0]:null;return this.each(function(){var e=c(this);if(d.prototype[b]&&e.data(d.prototype.name)&&"initialize"!=b)e.data(d.prototype.name)[b].apply(e.data(d.prototype.name),Array.prototype.slice.call(a,1));else if(!b||c.isPlainObject(b)){var f=new d;d.prototype.initialize&&f.initialize.apply(f,c.merge([e],a));e.data(d.prototype.name,f)}else c.error("Method "+b+" does not exist on jQuery."+
d.name)})};c.fn[d.prototype.name]=d;c.fn[d.prototype.name].iNextUnique=0})(jQuery);
(function(c){var d=function(a){this.options=c.extend({},c.fn.zluxItemsManager.prototype.options,this.options,a);this.events={}};d.prototype=c.extend(d.prototype,c.fn.zluxItemsManager.prototype,{name:"zluxDialogItemsManager",options:{title:"Items Manager",position:{},full_mode:0},events:{},initialize:function(a,b){this.options=c.extend({},this.options,b);var e=this;e.initCheck();e.filter={};e.dialogTrigger=a.on("click",function(){e.zluxdialog.toggle();return!1});e.initDialog();e.initMainEvents()},
initDialog:function(){var a=this;a.zluxdialog=(new c.fn.zluxDialog({title:a.options.title,width:a.options.full_mode?"75%":300,dialogClass:"zl-bootstrap zlux-itemsmanager "+(a.options.full_mode?"zlux-dialog-full":""),position:c.extend({of:a.dialogTrigger,my:"left top",at:"right bottom"},a.options.position)})).done(function(){a.zluxdialog.widget.attr("id","zluxItemsManager_"+a.ID);a.eventDialogLoaded()})},eventDialogLoaded:function(){var a=this;a.itemsmanager=c('<div class="zlux-itemsmanager" />').appendTo(a.zluxdialog.content);
a.initDataTable(a.itemsmanager);a.zluxdialog.main.on("click",".zlux-x-details-btn",function(){var b=c(this),e=b.closest("tr.zlux-object"),d=c("td.column-name",e),g=c(".zlux-x-details",e);d.hasClass("zlux-ui-open")?(b.addClass("icon-angle-down").removeClass("icon-angle-up"),d.removeClass("zlux-ui-open"),g.slideUp("fast",function(){a.zluxdialog.scrollbar("refresh")})):(d.addClass("zlux-ui-open"),b.removeClass("icon-angle-down").addClass("icon-angle-up"),a.zluxdialog.content.stop().animate({scrollTop:e.get(0).offsetTop},
900,"swing"),g.slideDown("fast",function(){a.zluxdialog.scrollbar("refresh")}))});c("html").on("mousedown",function(b){a.zluxdialog.dialog("isOpen")&&!a.dialogTrigger.is(b.target)&&!a.dialogTrigger.find(b.target).length&&!a.zluxdialog.widget.find(b.target).length&&!a.zluxdialog.widget.is(b.target)&&a.zluxdialog.dialog("close")});a.zluxdialog.setMainToolbar([{title:"Apply Filters",icon:"filter",click:function(b){c(".zlux-dialog-subtoolbar-filter",a.zluxdialog.toolbar.wrapper).slideToggle("fast");b.toggleClass("zlux-ui-tool-enabled")}},
{title:"Refresh",icon:"refresh",click:function(){a.reload()}}]);a.zluxdialog.newSubToolbar("filter","main")},initMainEvents:function(){var a=this;a.bind("InitComplete",function(){a.zluxdialog.scrollbar("refresh");var b=c(".zlux-dialog-subtoolbar-filter",a.zluxdialog.toolbar.wrapper);b.append(a.getSelect("aaApps","Filter by App",function(e){a.filter.apps=e;a.filter.types="";c(".btn-group[data-id=2]",b).attr("data-update",!0)},function(){a.filter.apps=""}),a.getSelect("aaTypes","Filter by Type",function(e){a.filter.types=
e;c(".btn-group[data-id=2]",b).attr("data-update",!1)},function(){a.filter.types=""}),a.getSelect("aaCategories","Filter by Category",function(b){a.filter.cats=b},function(){a.filter.cats=""}),a.getSelect("aaTags","Filter by Tag",function(b){a.filter.tags=b},function(){a.filter.tags=""}));c(".zlux-x-filter-input_wrapper",a.oTable.fnSettings().nTableWrapper).appendTo(b);a.zluxdialog.initContent()});a.bind("ItemSelected",function(a,c,d){d.siblings("[data-checked]").removeAttr("data-checked");input.val(c).trigger("change")});
a.bind("ItemUnselected",function(){input.val("").trigger("change")})},getSelect:function(a,b,d,f){var g=this,h=c.parseJSON(g.oTable.fnSettings().jqXHR.responseText)[a];if(!(1>=h.length)){var j=c('<a class="btn dropdown-toggle" data-toggle="dropdown" href="#">'+b+'<span class="caret" /></a>'),k=c('<ul class="dropdown-menu">'+g._getSelectOptions(h)+"</ul>"),l=c('<div class="btn-group" data-text="'+b+'" />').append(j,k),m=c('<i class="icon-remove zlux-ui-dropdown-unselect" />').on("click",function(){j.html(b+
'<span class="caret"></span>');m.hide();c.isFunction(f)&&f();g.reload()}).hide().prependTo(l);h.length||j.addClass("disabled");j.on("click",function(){if(j.hasClass("disabled"))return!1});k.on("click","a",function(a){var f=c(this).data("value")?c(this).data("value"):"",h=b,h=c(this).text().replace(/^[^a-zA-Z]+/g,"").replace(/[^a-zA-Z]+$/g,"");m.show();j.html(h+'<span class="caret"></span>').data("selected-value",f);c.isFunction(d)&&d(f);g.reload();a.preventDefault()});g.bind("TableDrawCallback",function(){var d=
c.parseJSON(g.oTable.fnSettings().jqXHR.responseText)[a];k.empty().append(g._getSelectOptions(d));d.length||l.addClass("disabled");var e=!1;c.each(d,function(a,b){b.id==j.data("selected-value")&&(e=!0)});e||(m.hide(),j.data("selected-value","").html(b+'<span class="caret"></span>'))});return l}},_getSelectOptions:function(a){var b,c=a.length,d=[];for(b=0;b<c;b++){var g='<li><a href="#" data-value="'+a[b].id+'">'+a[b].name+"</a></li>";-1<jQuery.inArray(g,d)||d.push(g)}return d.join("")}});c.fn[d.prototype.name]=
function(){var a=arguments,b=a[0]?a[0]:null;return this.each(function(){var e=c(this);if(d.prototype[b]&&e.data(d.prototype.name)&&"initialize"!=b)e.data(d.prototype.name)[b].apply(e.data(d.prototype.name),Array.prototype.slice.call(a,1));else if(!b||c.isPlainObject(b)){var f=new d;d.prototype.initialize&&f.initialize.apply(f,c.merge([e],a));e.data(d.prototype.name,f)}else c.error("Method "+b+" does not exist on jQuery."+d.name)})}})(jQuery);