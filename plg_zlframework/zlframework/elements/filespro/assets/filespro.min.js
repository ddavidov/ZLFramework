(function(a){var d=function(b){this.options=a.extend({},this.options,b);this.events={}};d.prototype=a.extend(d.prototype,a.fn.zluxMain.prototype,{name:"ElementFilespro",options:{root:"",extensions:"",storage:"",fileMode:"",max_file_size:"",title:""},events:{},initialize:function(b,c){this.options=a.extend({},a.fn.zluxMain.prototype.options,this.options,c);var d=this;d.element=b;b.on("click","p.add a",function(){d.apply(a("input.filespro",b).add("input.mediapro-element",b))});d.apply(a("input.filespro", b).add("input.mediapro-element",b))},apply:function(d){var c=this;d.each(function(d,b){var f=a(b);if(!a(b).data("initialized")){var e="filespro-element-"+d,g=f.closest(".row").addClass("zl-bootstrap"),l=f.hasClass("image-element")?!0:!1;f.attr("id",e);c.zluxpreview=a.fn.zluxPreview();e=a("span.zlux-x-filedata",g).data("zlux-storage");c.dialogTrigger=a('<a title="'+c.options.title+'" class="btn btn-mini zlux-btn-edit" href="#"><i class="icon-edit"></i></a>').appendTo(g);c.dialogTrigger.zluxDialogFilesManager({root:c.options.images, extensions:c.options.extensions,storage:"local",max_file_size:"1024kb",title:c.options.title,storage:e.engine,storage_params:e,root:e.root}).data("zluxDialogFilesManager").bind("ObjectSelected",function(d,b){if("files"!=c.options.fileMode||"file"==b.type)if("folders"!=c.options.fileMode||"folder"==b.type){var e=c.dialogTrigger.data("zluxDialogFilesManager")._getFullPath(b.name);f.val(e).trigger("change");a(".zlux-preview",g).remove();g.append(c.zluxpreview.renderPreviewDOM(b,l))}});e=a("span.zlux-x-filedata", g).data("zlux-data");!a.isEmptyObject(e)&&f.val()&&g.append(c.zluxpreview.renderPreviewDOM(e,l));a('<i class="icon-remove zlux-x-cancel-btn" />').insertAfter(f).on("click",function(){f.val("");a(".zlux-preview",g).remove()})}f.data("initialized",!0)})}});a.fn[d.prototype.name]=function(){var b=arguments,c=b[0]?b[0]:null;return this.each(function(){var h=a(this);if(d.prototype[c]&&h.data(d.prototype.name)&&"initialize"!=c)h.data(d.prototype.name)[c].apply(h.data(d.prototype.name),Array.prototype.slice.call(b, 1));else if(!c||a.isPlainObject(c)){var k=new d;d.prototype.initialize&&k.initialize.apply(k,a.merge([h],b));h.data(d.prototype.name,k)}else a.error("Method "+c+" does not exist on jQuery."+d.name)})}})(jQuery);