/* ===================================================
 * Files Pro edit script
 * https://zoolanders.com/extensions/zl-framework
 * ===================================================
 * Copyright (C) JOOlanders SL 
 * http://www.gnu.org/licenses/gpl-2.0.html GNU/GPLv2 only
 * ========================================================== */
(function(b){var a=function(c){this.options=b.extend({},this.options,c);this.events={}};a.prototype=b.extend(a.prototype,b.fn.zluxMain.prototype,{name:"ElementFilespro",options:{root:"",extensions:"",storage:"",fileMode:"",max_file_size:"",title:""},events:{},initialize:function(c,d){this.options=b.extend({},b.fn.zluxMain.prototype.options,this.options,d);var a=this;a.element=c;c.on("click","p.add a",function(){a.apply(b("input.filespro",c))});a.apply(b("input.filespro",c))},apply:function(a){var d= this;a.each(function(a,c){var e=b(c);if(!b(c).data("initialized")){var h="filespro-element-"+a,g=e.closest(".row").addClass("zl-bootstrap"),k=e.hasClass("image-element")?!0:!1;e.attr("id",h);d.zluxpreview=b.fn.zluxPreview();e.zluxDialogFilesManager({root:d.options.images,extensions:d.options.extensions,storage:"local",max_file_size:"1024kb",title:d.options.title}).data("zluxDialogFilesManager").bind("ObjectSelected",function(a,c){if(!("files"==d.options.fileMode&&"file"!=c.type)&&!("folders"==d.options.fileMode&& "folder"!=c.type)){var f=a.oTable.fnSettings().sCurrentPath+"/"+c.name;e.val(f).trigger("change");b(".zlux-preview",g).remove();g.append(d.zluxpreview.renderPreviewDOM(c,k))}});h=b("span.zlux-x-filedata",g).data("zlux-data");b.isEmptyObject(h)||g.append(d.zluxpreview.renderPreviewDOM(h,k));b('<i class="icon-remove zlux-x-cancel-btn" />').insertAfter(e).on("click",function(){e.val("");b(".zlux-preview",g).remove()})}e.data("initialized",!0)})}});b.fn[a.prototype.name]=function(){var c=arguments,d= c[0]?c[0]:null;return this.each(function(){var f=b(this);if(a.prototype[d]&&f.data(a.prototype.name)&&"initialize"!=d)f.data(a.prototype.name)[d].apply(f.data(a.prototype.name),Array.prototype.slice.call(c,1));else if(!d||b.isPlainObject(d)){var j=new a;a.prototype.initialize&&j.initialize.apply(j,b.merge([f],c));f.data(a.prototype.name,j)}else b.error("Method "+d+" does not exist on jQuery."+a.name)})}})(jQuery);